<!DOCTYPE html>
<!-- saved from url=(0080)https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/ -->
<html lang="en" data-blockbyte-bs-uid="62081"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.4">
<meta name="author" content="Rob Winch, Vedran Pavić, Jay Bryant">
<title>Spring Session</title>
<link rel="stylesheet" href="./Spring Session_files/css">
<style>article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}audio,canvas,video{display:inline-block}audio:not([controls]){display:none;height:0}[hidden],template{display:none}script{display:none!important}html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}a{background:transparent}a:focus{outline:thin dotted}a:active,a:hover{outline:0}h1{font-size:2em;margin:.67em 0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:bold}dfn{font-style:italic}hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}mark{background:#ff0;color:#000}code,kbd,pre,samp{font-family:monospace;font-size:1em}pre{white-space:pre-wrap}q{quotes:"\201C" "\201D" "\2018" "\2019"}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}img{border:0}svg:not(:root){overflow:hidden}figure{margin:0}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{border:0;padding:0}button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}button,input{line-height:normal}button,select{text-transform:none}button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}textarea{overflow:auto;vertical-align:top}table{border-collapse:collapse;border-spacing:0}*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}html,body{font-size:100%}body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}a:hover{cursor:pointer}img,object,embed{max-width:100%;height:auto}object,embed{height:100%}img{-ms-interpolation-mode:bicubic}.left{float:left!important}.right{float:right!important}.text-left{text-align:left!important}.text-right{text-align:right!important}.text-center{text-align:center!important}.text-justify{text-align:justify!important}.hide{display:none}body{-webkit-font-smoothing:antialiased}img,object,svg{display:inline-block;vertical-align:middle}textarea{height:auto;min-height:50px}select{width:100%}.center{margin-left:auto;margin-right:auto}.spread{width:100%}p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}a{color:#2156a5;text-decoration:underline;line-height:inherit}a:hover,a:focus{color:#1d4b8f}a img{border:none}p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}p aside{font-size:.875em;line-height:1.35;font-style:italic}h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}h1{font-size:2.125em}h2{font-size:1.6875em}h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}h4,h5{font-size:1.125em}h6{font-size:1em}hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}em,i{font-style:italic;line-height:inherit}strong,b{font-weight:bold;line-height:inherit}small{font-size:60%;line-height:inherit}code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}ul.square{list-style-type:square}ul.circle{list-style-type:circle}ul.disc{list-style-type:disc}ul.no-bullet{list-style:none}ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}dl dt{margin-bottom:.3125em;font-weight:bold}dl dd{margin-bottom:1.25em}abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}abbr{text-transform:none}blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}blockquote cite:before{content:"\2014 \0020"}blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}h1{font-size:2.75em}h2{font-size:2.3125em}h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}h4{font-size:1.4375em}}table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}table thead,table tfoot{background:#f7f8f7;font-weight:bold}table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}body{tab-size:4}h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}.clearfix:after,.float-group:after{clear:both}*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}.keyseq{color:rgba(51,51,51,.8)}kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2) , 0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2) , 0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}.keyseq kbd:first-child{margin-left:0}.keyseq kbd:last-child{margin-right:0}.menuseq,.menu{color:rgba(0,0,0,.8)}b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}b.button:before{content:"[";padding:0 3px 0 2px}b.button:after{content:"]";padding:0 2px 0 3px}p a>code:hover{color:rgba(0,0,0,.9)}#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}#header:after,#content:after,#footnotes:after,#footer:after{clear:both}#content{margin-top:1.25em}#content:before{content:none}#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}#header .details span:first-child{margin-left:-.125em}#header .details span.email a{color:rgba(0,0,0,.85)}#header .details br{display:none}#header .details br+span:before{content:"\00a0\2013\00a0"}#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}#header .details br+span#revremark:before{content:"\00a0|\00a0"}#header #revnumber{text-transform:capitalize}#header #revnumber:after{content:"\00a0"}#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}#toc>ul{margin-left:.125em}#toc ul.sectlevel0>li>a{font-style:italic}#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}#toc li{line-height:1.3334;margin-top:.3334em}#toc a{text-decoration:none}#toc a:active{text-decoration:underline}#toctitle{color:#7a2518;font-size:1.2em}@media only screen and (min-width:768px){#toctitle{font-size:1.375em}body.toc2{padding-left:15em;padding-right:0}#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}#toc.toc2>ul{font-size:.9em;margin-bottom:0}#toc.toc2 ul ul{margin-left:0;padding-left:1em}#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}body.toc2.toc-right{padding-left:0;padding-right:15em}body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}#toc.toc2{width:20em}#toc.toc2 #toctitle{font-size:1.375em}#toc.toc2>ul{font-size:.95em}#toc.toc2 ul ul{padding-left:1.25em}body.toc2.toc-right{padding-left:0;padding-right:20em}}#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}#content #toc>:first-child{margin-top:0}#content #toc>:last-child{margin-bottom:0}#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}#footer-text{color:rgba(255,255,255,.8);line-height:1.44}.sect1{padding-bottom:.625em}@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}.sect1+.sect1{border-top:1px solid #efefed}#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}.admonitionblock>table td.icon{text-align:center;width:80px}.admonitionblock>table td.icon img{max-width:none}.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}.exampleblock>.content>:first-child{margin-top:0}.exampleblock>.content>:last-child{margin-bottom:0}.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}.sidebarblock>:first-child{margin-top:0}.sidebarblock>:last-child{margin-bottom:0}.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}.listingblock pre.highlightjs{padding:0}.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}.listingblock pre.prettyprint{border-width:0}.listingblock>.content{position:relative}.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}.listingblock:hover code[data-lang]:before{display:block}.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}table.pyhltable td.code{padding-left:.75em;padding-right:0}pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}pre.pygments .lineno{display:inline-block;margin-right:.25em}table.pyhltable .linenodiv{background:none!important;padding-right:0!important}.quoteblock{margin:0 1em 1.25em 1.5em;display:table}.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}.quoteblock blockquote{margin:0;padding:0;border:0}.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}.quoteblock .quoteblock blockquote:before{display:none}.verseblock{margin:0 1em 1.25em 1em}.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}.verseblock pre strong{font-weight:400}.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}.quoteblock .attribution br,.verseblock .attribution br{display:none}.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}.quoteblock.abstract{margin:0 0 1.25em 0;display:block}.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}table.tableblock{max-width:100%;border-collapse:separate}table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}table.frame-all{border-width:1px}table.frame-sides{border-width:0 1px}table.frame-topbot{border-width:1px 0}th.halign-left,td.halign-left{text-align:left}th.halign-right,td.halign-right{text-align:right}th.halign-center,td.halign-center{text-align:center}th.valign-top,td.valign-top{vertical-align:top}th.valign-bottom,td.valign-bottom{vertical-align:bottom}th.valign-middle,td.valign-middle{vertical-align:middle}table thead th,table tfoot th{font-weight:bold}tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}p.tableblock>code:only-child{background:none;padding:0}p.tableblock{font-size:1em}td>div.verse{white-space:pre}ol{margin-left:1.75em}ul li ol{margin-left:1.5em}dl dd{margin-left:1.125em}dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}ul.inline>li>*{display:block}.unstyled dl dt{font-weight:400;font-style:normal}ol.arabic{list-style-type:decimal}ol.decimal{list-style-type:decimal-leading-zero}ol.loweralpha{list-style-type:lower-alpha}ol.upperalpha{list-style-type:upper-alpha}ol.lowerroman{list-style-type:lower-roman}ol.upperroman{list-style-type:upper-roman}ol.lowergreek{list-style-type:lower-greek}.hdlist>table,.colist>table{border:0;background:none}.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}td.hdlist1{font-weight:bold;padding-bottom:1.25em}.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}.colist>table tr>td:last-of-type{padding:.25em 0}.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}.imageblock>.title{margin-bottom:0}.imageblock.thumb,.imageblock.th{border-width:6px}.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}.image.left{margin-right:.625em}.image.right{margin-left:.625em}a.image{text-decoration:none;display:inline-block}a.image object{pointer-events:none}sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}sup.footnote a,sup.footnoteref a{text-decoration:none}sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}#footnotes .footnote:last-of-type{margin-bottom:0}#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}.gist .file-data>table td.line-data{width:99%}div.unbreakable{page-break-inside:avoid}.big{font-size:larger}.small{font-size:smaller}.underline{text-decoration:underline}.overline{text-decoration:overline}.line-through{text-decoration:line-through}.aqua{color:#00bfbf}.aqua-background{background-color:#00fafa}.black{color:#000}.black-background{background-color:#000}.blue{color:#0000bf}.blue-background{background-color:#0000fa}.fuchsia{color:#bf00bf}.fuchsia-background{background-color:#fa00fa}.gray{color:#606060}.gray-background{background-color:#7d7d7d}.green{color:#006000}.green-background{background-color:#007d00}.lime{color:#00bf00}.lime-background{background-color:#00fa00}.maroon{color:#600000}.maroon-background{background-color:#7d0000}.navy{color:#000060}.navy-background{background-color:#00007d}.olive{color:#606000}.olive-background{background-color:#7d7d00}.purple{color:#600060}.purple-background{background-color:#7d007d}.red{color:#bf0000}.red-background{background-color:#fa0000}.silver{color:#909090}.silver-background{background-color:#bcbcbc}.teal{color:#006060}.teal-background{background-color:#007d7d}.white{color:#bfbfbf}.white-background{background-color:#fafafa}.yellow{color:#bfbf00}.yellow-background{background-color:#fafa00}span.icon>.fa{cursor:default}.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}.conum[data-value] *{color:#fff!important}.conum[data-value]+b{display:none}.conum[data-value]:after{content:attr(data-value)}pre .conum[data-value]{position:relative;top:-.125em}b.conum *{color:inherit!important}.conum:not([data-value]):empty{display:none}dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}h1,h2,p,td.content,span.alt{letter-spacing:-.01em}p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}p{margin-bottom:1.25rem}.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}.print-only{display:none!important}@media print{@page{margin:1.25cm .75cm}*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}a{color:inherit!important;text-decoration:underline!important}a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}abbr[title]:after{content:" (" attr(title) ")"}pre,blockquote,tr,img,object,svg{page-break-inside:avoid}thead{display:table-header-group}svg{max-width:100%}p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}#toc,.sidebarblock,.exampleblock>.content{background:none!important}#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}.sect1{padding-bottom:0!important}.sect1+.sect1{border:0!important}#header>h1:first-child{margin-top:1.25rem}body.book #header{text-align:center}body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}body.book #header .details{border:0!important;display:block;padding:0!important}body.book #header .details span:first-child{margin-left:0!important}body.book #header .details br{display:block}body.book #header .details br+span:before{content:none!important}body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}.listingblock code[data-lang]:before{display:block}#footer{background:none!important;padding:0 .9375em}#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}.hide-on-print{display:none!important}.print-only{display:block!important}.hide-for-print{display:none!important}.show-for-print{display:inherit!important}}</style>
<link rel="stylesheet" href="./Spring Session_files/font-awesome.min.css">
<style class="blockbyte-bs-style" data-name="content">body>div#blockbyte-bs-indicator>div{opacity:0;pointer-events:none}body>iframe#blockbyte-bs-sidebar.blockbyte-bs-visible,body>iframe#blockbyte-bs-overlay.blockbyte-bs-visible{opacity:1;pointer-events:auto}body.blockbyte-bs-noscroll{overflow:hidden !important}body>div#blockbyte-bs-indicator>div{position:absolute;transform:translate3d(-40px, 0, 0);top:0;left:0;width:40px !important;height:100%;background:rgba(0,0,0,0.5);border-radius:0 10px 10px 0;transition:opacity 0.3s, transform 0.3s;z-index:2}body>div#blockbyte-bs-indicator>div>span{-webkit-mask:no-repeat center/32px;-webkit-mask-image:url(chrome-extension://jdbnofccmhefkmjbkkdkfiicjkgofkdh/img/icon-bookmark.svg);background-color:#ffffff;position:absolute;display:block;top:0;left:0;width:100%;height:100%}body>div#blockbyte-bs-indicator[data-pos='right']{left:auto;right:0}body>div#blockbyte-bs-indicator[data-pos='right']>div{transform:translate3d(40px, 0, 0);left:auto;right:0;border-radius:10px 0 0 10px}body>div#blockbyte-bs-indicator.blockbyte-bs-fullHeight>div{border-radius:0}body>div#blockbyte-bs-indicator.blockbyte-bs-hover>div{transform:translate3d(0, 0, 0);opacity:1}body>div#blockbyte-bs-indicator[data-pos='left'].blockbyte-bs-has-lsb{height:100% !important;top:0 !important}body>div#blockbyte-bs-indicator[data-pos='left'].blockbyte-bs-has-lsb>div{background:transparent}body>div#blockbyte-bs-indicator[data-pos='left'].blockbyte-bs-has-lsb>div>span{-webkit-mask-position-y:20px}body>iframe#blockbyte-bs-sidebar{width:350px;max-width:none;height:0;z-index:2147483646;background-color:transparent !important;border:none;display:block !important;transform:translate3d(-350px, 0, 0);transition:width 0s 0.3s, height 0s 0.3s, opacity 0.3s, transform 0.3s}body>iframe#blockbyte-bs-sidebar[data-pos='right']{left:auto;right:0;transform:translate3d(350px, 0, 0)}body>iframe#blockbyte-bs-sidebar.blockbyte-bs-visible{width:calc(100% + 350px);height:100%;transform:translate3d(0, 0, 0);transition:opacity 0.3s, transform 0.3s}body>iframe#blockbyte-bs-sidebar.blockbyte-bs-hideMask{background:none !important}body>iframe#blockbyte-bs-sidebar.blockbyte-bs-hideMask:not(.blockbyte-bs-hover){width:calc(350px + 50px)}body>iframe#blockbyte-bs-overlay{width:100%;max-width:none;height:100%;z-index:2147483647;border:none;background:rgba(0,0,0,0.5) !important;transition:opacity 0.3s}
</style></head>
<body class="book toc2 toc-left vsc-initialized">
<div id="header">
<h1>Spring Session</h1>
<div class="details">
<span id="author" class="author">Rob Winch</span><br>
<span id="author2" class="author">Vedran Pavić</span><br>
<span id="author3" class="author">Jay Bryant</span><br>
<span id="revnumber">version 2.1.6.BUILD-SNAPSHOT</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#introduction">1. Introduction</a></li>
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#what-s-new-in-2-0">2. What’s New in 2.0</a></li>
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#samples">3. Samples and Guides (Start Here)</a></li>
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#modules">4. Spring Session Modules</a></li>
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession">5. <code>HttpSession</code> Integration</a>
<ul class="sectlevel2">
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession-why">5.1. Why Spring Session and <code>HttpSession</code>?</a></li>
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession-redis">5.2. <code>HttpSession</code> with Redis</a></li>
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession-jdbc">5.3. <code>HttpSession</code> with JDBC</a></li>
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession-hazelcast">5.4. HttpSession with Hazelcast</a></li>
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession-how">5.5. How <code>HttpSession</code> Integration Works</a></li>
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession-rest">5.6. <code>HttpSession</code> and RESTful APIs</a></li>
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession-httpsessionlistener">5.7. Using <code>HttpSessionListener</code></a></li>
</ul>
</li>
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#websocket">6. WebSocket Integration</a>
<ul class="sectlevel2">
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#websocket-why">6.1. Why Spring Session and WebSockets?</a></li>
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#websocket-usage">6.2. WebSocket Usage</a></li>
</ul>
</li>
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#websession">7. WebSession Integration</a>
<ul class="sectlevel2">
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#websession-why">7.1. Why Spring Session and WebSession?</a></li>
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#websession-redis">7.2. WebSession with Redis</a></li>
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#websession-how">7.3. How WebSession Integration Works</a></li>
</ul>
</li>
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#spring-security">8. Spring Security Integration</a>
<ul class="sectlevel2">
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#spring-security-rememberme">8.1. Spring Security Remember-me Support</a></li>
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#spring-security-concurrent-sessions">8.2. Spring Security Concurrent Session Control</a></li>
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#spring-security-concurrent-sessions-limitations">8.3. Limitations</a></li>
</ul>
</li>
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api">9. API Documentation</a>
<ul class="sectlevel2">
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-session">9.1. Using <code>Session</code></a></li>
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-sessionrepository">9.2. Using <code>SessionRepository</code></a></li>
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-findbyindexnamesessionrepository">9.3. Using <code>FindByIndexNameSessionRepository</code></a></li>
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-reactivesessionrepository">9.4. Using <code>ReactiveSessionRepository</code></a></li>
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-enablespringhttpsession">9.5. Using <code>@EnableSpringHttpSession</code></a></li>
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-enablespringwebsession">9.6. Using <code>@EnableSpringWebSession</code></a></li>
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-redisoperationssessionrepository">9.7. Using <code>RedisOperationsSessionRepository</code></a></li>
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-reactiveredisoperationssessionrepository">9.8. Using <code>ReactiveRedisOperationsSessionRepository</code></a></li>
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-mapsessionrepository">9.9. Using <code>MapSessionRepository</code></a></li>
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-reactivemapsessionrepository">9.10. Using <code>ReactiveMapSessionRepository</code></a></li>
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-jdbcoperationssessionrepository">9.11. Using <code>JdbcOperationsSessionRepository</code></a></li>
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-hazelcastsessionrepository">9.12. Using <code>HazelcastSessionRepository</code></a></li>
</ul>
</li>
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#custom-sessionrepository">10. Customing <code>SessionRepository</code></a></li>
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#upgrading-2.0">11. Upgrading to 2.x</a>
<ul class="sectlevel2">
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#baseline-update">11.1. Baseline Update</a></li>
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#replaced-and-removed-modules">11.2. Replaced and Removed Modules</a></li>
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#replaced-and-removed-packages-classes-and-methods">11.3. Replaced and Removed Packages, Classes, and Methods</a></li>
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#dropped-support">11.4. Dropped Support</a></li>
</ul>
</li>
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#community">12. Spring Session Community</a>
<ul class="sectlevel2">
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#community-support">12.1. Support</a></li>
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#community-source">12.2. Source Code</a></li>
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#community-issues">12.3. Issue Tracking</a></li>
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#community-contributing">12.4. Contributing</a></li>
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#community-license">12.5. License</a></li>
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#community-extensions">12.6. Community Extensions</a></li>
</ul>
</li>
<li><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#minimum-requirements">13. Minimum Requirements</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div id="abstract" class="paragraph">
<p>Spring Session provides an API and implementations for managing a user’s session information.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="introduction"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#introduction"></a>1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Session provides an API and implementations for managing a user’s session information while also making it trivial to support clustered sessions without being tied to an application container-specific solution.
It also provides transparent integration with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession">HttpSession</a>: Allows replacing the <code>HttpSession</code> in an application container-neutral way, with support for providing session IDs in headers to work with RESTful APIs.</p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#websocket">WebSocket</a>: Provides the ability to keep the <code>HttpSession</code> alive when receiving WebSocket messages</p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#websession">WebSession</a>: Allows replacing the Spring WebFlux’s <code>WebSession</code> in an application container-neutral way.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="what-s-new-in-2-0"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#what-s-new-in-2-0"></a>2. What’s New in 2.0</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following list highlights what is new in Spring Session 2.0:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Upgraded to Java 8 and Spring Framework 5 as baseline</p>
</li>
<li>
<p><a href="https://github.com/spring-projects/spring-session/issues/683">Added support for managing Spring WebFlux’s <code>WebSession</code></a> with <a href="https://github.com/spring-projects/spring-session/issues/816">Redis <code>ReactiveSessionRepository</code></a></p>
</li>
<li>
<p><a href="https://github.com/spring-projects/spring-session/issues/768">Extracted <code>SessionRepository</code> implementations to separate modules</a></p>
</li>
<li>
<p>Improved <a href="https://github.com/spring-projects/spring-session/issues/682"><code>Session</code></a> and <a href="https://github.com/spring-projects/spring-session/issues/809"><code>SessionRepository</code></a> APIs</p>
</li>
<li>
<p>Improved and harmonized configuration support for all supported session stores</p>
</li>
<li>
<p><a href="https://github.com/spring-projects/spring-session/pull/713">Added support for configuring default <code>CookieSerializer</code> using <code>SessionCookieConfig</code></a></p>
</li>
<li>
<p>Lots of performance improvements and bug fixes</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can find a complete list of what is new by referring to the changelogs of</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/spring-projects/spring-session/milestone/17?closed=1">2.0.0.M1</a></p>
</li>
<li>
<p><a href="https://github.com/spring-projects/spring-session/milestone/22?closed=1">2.0.0.M2</a></p>
</li>
<li>
<p><a href="https://github.com/spring-projects/spring-session/milestone/23?closed=1">2.0.0.M3</a></p>
</li>
<li>
<p><a href="https://github.com/spring-projects/spring-session/milestone/24?closed=1">2.0.0.M4</a></p>
</li>
<li>
<p><a href="https://github.com/spring-projects/spring-session/milestone/25?closed=1">2.0.0.M5</a></p>
</li>
<li>
<p><a href="https://github.com/spring-projects/spring-session/milestone/26?closed=1">2.0.0.RC1</a></p>
</li>
<li>
<p><a href="https://github.com/spring-projects/spring-session/milestone/27?closed=1">2.0.0.RC2</a></p>
</li>
<li>
<p><a href="https://github.com/spring-projects/spring-session/milestone/30?closed=1">2.0.0.RELEASE</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="samples"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#samples"></a>3. Samples and Guides (Start Here)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To get started with Spring Session, the best place to start is our Sample Applications.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. Sample Applications that use Spring Boot</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Source</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Guide</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/master/samples/boot/redis">HttpSession with Redis</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session to replace the <code>HttpSession</code> with Redis.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/guides/boot-redis.html">HttpSession with Redis Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/master/samples/boot/jdbc">HttpSession with JDBC</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session to replace the <code>HttpSession</code> with a relational database store.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/guides/boot-jdbc.html">HttpSession with JDBC Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/master/samples/boot/findbyusername">Find by Username</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session to find sessions by username.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/guides/boot-findbyusername.html">Find by Username Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/master/samples/boot/websocket">WebSockets</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session with WebSockets.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/guides/boot-websocket.html">WebSockets Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/master/samples/boot/webflux">WebFlux</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session to replace the Spring WebFlux’s <code>WebSession</code> with Redis.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/master/samples/boot/redis-json">HttpSession with Redis JSON serialization</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session to replace the <code>HttpSession</code> with Redis using JSON serialization.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 2. Sample Applications that use Spring Java-based configuration</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Source</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Guide</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/master/samples/javaconfig/redis">HttpSession with Redis</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session to replace the <code>HttpSession</code> with Redis.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/guides/java-redis.html">HttpSession with Redis Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/master/samples/javaconfig/jdbc">HttpSession with JDBC</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session to replace the <code>HttpSession</code> with a relational database store.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/guides/java-jdbc.html">HttpSession with JDBC Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/master/samples/javaconfig/hazelcast">HttpSession with Hazelcast</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session to replace the <code>HttpSession</code> with Hazelcast.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/guides/java-hazelcast.html">HttpSession with Hazelcast Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/master/samples/javaconfig/custom-cookie">Custom Cookie</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session and customize the cookie.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/guides/java-custom-cookie.html">Custom Cookie Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/master/samples/javaconfig/security">Spring Security</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session with an existing Spring Security application.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/guides/java-security.html">Spring Security Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/master/samples/javaconfig/rest">REST</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session in a REST application to support authenticating with a header.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/guides/java-rest.html">REST Guide</a></p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 3. Sample Applications that use Spring XML-based configuration</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Source</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Guide</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/master/samples/xml/redis">HttpSession with Redis</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session to replace the <code>HttpSession</code> with a Redis store.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/guides/xml-redis.html">HttpSession with Redis Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/master/samples/xml/jdbc">HttpSession with JDBC</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session to replace the <code>HttpSession</code> with a relational database store.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/guides/xml-jdbc.html">HttpSession with JDBC Guide</a></p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 4. Miscellaneous sample Applications</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Source</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Guide</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/master/samples/misc/grails3">Grails 3</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session with Grails 3.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/guides/grails3.html">Grails 3 Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/master/samples/misc/hazelcast">Hazelcast</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session with Hazelcast in a Java EE application.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TBD</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="modules"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#modules"></a>4. Spring Session Modules</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In Spring Session 1.x, all of the Spring Session’s <code>SessionRepository</code> implementations were available within the <code>spring-session</code> artifact.
While convenient, this approach was not sustainable long-term as more features and <code>SessionRepository</code> implementations were added to the project.</p>
</div>
<div class="paragraph">
<p>Starting with Spring Session 2.0, the project has been split into Spring Session Core module and several other modules that carry <code>SessionRepository</code> implementations and functionality related to the specific data store.
Users of Spring Data should find this arrangement familiar, with Spring Session Core module taking a role equivalent to Spring Data Commons and providing core functionalities and APIs, with other modules containing data store specific implementations.
As part of this split, the Spring Session Data MongoDB and Spring Session Data GemFire modules were moved to separate repositories.
Now the situation with project’s repositories/modules is as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/spring-projects/spring-session"><code>spring-session</code> repository</a></p>
<div class="ulist">
<ul>
<li>
<p>Hosts the Spring Session Core, Spring Session Data Redis, Spring Session JDBC, and Spring Session Hazelcast modules</p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="https://github.com/spring-projects/spring-session-data-mongodb"><code>spring-session-data-mongodb</code> repository</a></p>
<div class="ulist">
<ul>
<li>
<p>Hosts the Spring Session Data MongoDB module</p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="https://github.com/spring-projects/spring-session-data-geode"><code>spring-session-data-geode</code> repository</a></p>
<div class="ulist">
<ul>
<li>
<p>Hosts the Spring Session Data Geode and Spring Session Data Geode modules</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Finally, Spring Session now also provides a Maven BOM (“bill of materials”) module in order to help users with version management concerns:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/spring-projects/spring-session-bom"><code>spring-session-bom</code> repository</a></p>
<div class="ulist">
<ul>
<li>
<p>Hosts the Spring Session BOM module</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="httpsession"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession"></a>5. <code>HttpSession</code> Integration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Session provides transparent integration with <code>HttpSession</code>.
This means that developers can switch the <code>HttpSession</code> implementation out with an implementation that is backed by Spring Session.</p>
</div>
<div class="sect2">
<h3 id="httpsession-why"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession-why"></a>5.1. Why Spring Session and <code>HttpSession</code>?</h3>
<div class="paragraph">
<p>We have already mentioned that Spring Session provides transparent integration with <code>HttpSession</code>, but what benefits do we get out of this?</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Clustered Sessions</strong>: Spring Session makes it trivial to support <a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession-redis">clustered sessions</a> without being tied to an application container specific solution.</p>
</li>
<li>
<p><strong>RESTful APIs</strong>: Spring Session lets providing session IDs in headers work with <a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession-rest">RESTful APIs</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="httpsession-redis"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession-redis"></a>5.2. <code>HttpSession</code> with Redis</h3>
<div class="paragraph">
<p>Using Spring Session with <code>HttpSession</code> is enabled by adding a Servlet Filter before anything that uses the <code>HttpSession</code>.
You can choose from enabling this by using either:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession-redis-jc">Java-based Configuration</a></p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession-redis-xml">XML-based Configuration</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="httpsession-redis-jc"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession-redis-jc"></a>5.2.1. Redis Java-based Configuration</h4>
<div class="paragraph">
<p>This section describes how to use Redis to back <code>HttpSession</code> by using Java based configuration.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#samples">HttpSession Sample</a> provides a working sample of how to integrate Spring Session and <code>HttpSession</code> by using Java configuration.
You can read the basic steps for integration in the next few sections, but we encourage you to follow along with the detailed HttpSession Guide when integrating with your own application.
</td>
</tr>
</tbody></table>
</div>
<div class="sect4">
<h5 id="httpsession-spring-configuration"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession-spring-configuration"></a>Spring Java Configuration</h5>
<div class="paragraph">
<p>After adding the required dependencies, we can create our Spring configuration.
The Spring configuration is responsible for creating a servlet filter that replaces the <code>HttpSession</code> implementation with an implementation backed by Spring Session.
To do so, add the following Spring Configuration:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="lit">@EnableRedisHttpSession</span><span class="pln"> </span><i class="conum" data-value="1"></i><b><span class="pun">(</span><span class="lit">1</span><span class="pun">)</span></b><span class="pln">
</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Config</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

	</span><span class="lit">@Bean</span><span class="pln">
	</span><span class="kwd">public</span><span class="pln"> </span><span class="typ">LettuceConnectionFactory</span><span class="pln"> connectionFactory</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">LettuceConnectionFactory</span><span class="pun">();</span><span class="pln"> </span><i class="conum" data-value="2"></i><b><span class="pun">(</span><span class="lit">2</span><span class="pun">)</span></b><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>@EnableRedisHttpSession</code> annotation creates a Spring Bean with the name of <code>springSessionRepositoryFilter</code> that implements <code>Filter</code>.
The filter is in charge of replacing the <code>HttpSession</code> implementation to be backed by Spring Session.
In this instance, Spring Session is backed by Redis.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We create a <code>RedisConnectionFactory</code> that connects Spring Session to the Redis Server.
We configure the connection to connect to localhost on the default port (6379).
For more information on configuring Spring Data Redis, see the <a href="https://docs.spring.io/spring-data/data-redis/docs/2.1.8.RELEASE/reference/html/">reference documentation</a>.</td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="java-servlet-container-initialization"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#java-servlet-container-initialization"></a>Java Servlet Container Initialization</h5>
<div class="paragraph">
<p>Our <a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession-spring-configuration">Spring Configuration</a> created a Spring Bean named <code>springSessionRepositoryFilter</code> that implements <code>Filter</code>.
The <code>springSessionRepositoryFilter</code> bean is responsible for replacing the <code>HttpSession</code> with a custom implementation that is backed by Spring Session.</p>
</div>
<div class="paragraph">
<p>In order for our <code>Filter</code> to do its magic, Spring needs to load our <code>Config</code> class.
Last, we need to ensure that our Servlet Container (that is, Tomcat) uses our <code>springSessionRepositoryFilter</code> for every request.
Fortunately, Spring Session provides a utility class named <code>AbstractHttpSessionApplicationInitializer</code> to make both of these steps easy.
The following shows an example:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="title">src/main/java/sample/Initializer.java</div>
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Initializer</span><span class="pln"> </span><span class="kwd">extends</span><span class="pln"> </span><span class="typ">AbstractHttpSessionApplicationInitializer</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><i class="conum" data-value="1"></i><b><span class="pun">(</span><span class="lit">1</span><span class="pun">)</span></b><span class="pln">

	</span><span class="kwd">public</span><span class="pln"> </span><span class="typ">Initializer</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">super</span><span class="pun">(</span><span class="typ">Config</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">);</span><span class="pln"> </span><i class="conum" data-value="2"></i><b><span class="pun">(</span><span class="lit">2</span><span class="pun">)</span></b><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The name of our class (<code>Initializer</code>) does not matter. What is important is that we extend <code>AbstractHttpSessionApplicationInitializer</code>.
</td>
</tr>
</tbody></table>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The first step is to extend <code>AbstractHttpSessionApplicationInitializer</code>.
Doing so ensures that the Spring Bean by the name of <code>springSessionRepositoryFilter</code> is registered with our Servlet Container for every request.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>AbstractHttpSessionApplicationInitializer</code> also provides a mechanism to ensure Spring loads our <code>Config</code>.</td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="httpsession-redis-xml"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession-redis-xml"></a>5.2.2. Redis XML-based Configuration</h4>
<div class="paragraph">
<p>This section describes how to use Redis to back <code>HttpSession</code> by using XML based configuration.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#samples">HttpSession XML Sample</a> provides a working sample of how to integrate Spring Session and <code>HttpSession</code> using XML configuration.
You can read the basic steps for integration in the next few sections, but we encourage you to follow along with the detailed HttpSession XML Guide when integrating with your own application.
</td>
</tr>
</tbody></table>
</div>
<div class="sect4">
<h5 id="httpsession-xml-spring-configuration"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession-xml-spring-configuration"></a>Spring XML Configuration</h5>
<div class="paragraph">
<p>After adding the required dependencies, we can create our Spring configuration.
The Spring configuration is responsible for creating a servlet filter that replaces the <code>HttpSession</code> implementation with an implementation backed by Spring Session.
To do so, add the following Spring Configuration:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="title">src/main/webapp/WEB-INF/spring/session.xml</div>
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-xml" data-lang="xml"><i class="conum" data-value="1"></i><b><span class="pln">(1)</span></b><span class="pln">
</span><span class="tag">&lt;context:annotation-config/&gt;</span><span class="pln">
</span><span class="tag">&lt;bean</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"org.springframework.session.data.redis.config.annotation.web.http.RedisHttpSessionConfiguration"</span><span class="tag">/&gt;</span><span class="pln">

</span><i class="conum" data-value="2"></i><b><span class="pln">(2)</span></b><span class="pln">
</span><span class="tag">&lt;bean</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory"</span><span class="tag">/&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We use the combination of <code>&lt;context:annotation-config/&gt;</code> and <code>RedisHttpSessionConfiguration</code> because Spring Session does not yet provide XML Namespace support (see <a href="https://github.com/spring-projects/spring-session/issues/104">gh-104</a>).
This creates a Spring Bean with the name of <code>springSessionRepositoryFilter</code> that implements <code>Filter</code>.
The filter is in charge of replacing the <code>HttpSession</code> implementation to be backed by Spring Session.
In this instance, Spring Session is backed by Redis.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We create a <code>RedisConnectionFactory</code> that connects Spring Session to the Redis Server.
We configure the connection to connect to localhost on the default port (6379)
For more information on configuring Spring Data Redis, see the <a href="https://docs.spring.io/spring-data/data-redis/docs/2.1.8.RELEASE/reference/html/">reference documentation</a>.</td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="xml-servlet-container-initialization"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#xml-servlet-container-initialization"></a>XML Servlet Container Initialization</h5>
<div class="paragraph">
<p>Our <a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession-xml-spring-configuration">Spring Configuration</a> created a Spring Bean named <code>springSessionRepositoryFilter</code> that implements <code>Filter</code>.
The <code>springSessionRepositoryFilter</code> bean is responsible for replacing the <code>HttpSession</code> with a custom implementation that is backed by Spring Session.</p>
</div>
<div class="paragraph">
<p>In order for our <code>Filter</code> to do its magic, we need to instruct Spring to load our <code>session.xml</code> configuration.
We can do so with the following configuration:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="title">src/main/webapp/WEB-INF/web.xml</div>
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-xml" data-lang="xml"><span class="tag">&lt;context-param&gt;</span><span class="pln">
	</span><span class="tag">&lt;param-name&gt;</span><span class="pln">contextConfigLocation</span><span class="tag">&lt;/param-name&gt;</span><span class="pln">
	</span><span class="tag">&lt;param-value&gt;</span><span class="pln">
		/WEB-INF/spring/*.xml
	</span><span class="tag">&lt;/param-value&gt;</span><span class="pln">
</span><span class="tag">&lt;/context-param&gt;</span><span class="pln">
</span><span class="tag">&lt;listener&gt;</span><span class="pln">
	</span><span class="tag">&lt;listener-class&gt;</span><span class="pln">
		org.springframework.web.context.ContextLoaderListener
	</span><span class="tag">&lt;/listener-class&gt;</span><span class="pln">
</span><span class="tag">&lt;/listener&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <a href="https://docs.spring.io/spring/docs/5.1.7.RELEASE/spring-framework-reference/core.html#context-create"><code>ContextLoaderListener</code></a> reads the contextConfigLocation and picks up our session.xml configuration.</p>
</div>
<div class="paragraph">
<p>Last, we need to ensure that our Servlet Container (that is, Tomcat) uses our <code>springSessionRepositoryFilter</code> for every request.
The following snippet performs this last step for us:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="title">src/main/webapp/WEB-INF/web.xml</div>
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-xml" data-lang="xml"><span class="tag">&lt;filter&gt;</span><span class="pln">
	</span><span class="tag">&lt;filter-name&gt;</span><span class="pln">springSessionRepositoryFilter</span><span class="tag">&lt;/filter-name&gt;</span><span class="pln">
	</span><span class="tag">&lt;filter-class&gt;</span><span class="pln">org.springframework.web.filter.DelegatingFilterProxy</span><span class="tag">&lt;/filter-class&gt;</span><span class="pln">
</span><span class="tag">&lt;/filter&gt;</span><span class="pln">
</span><span class="tag">&lt;filter-mapping&gt;</span><span class="pln">
	</span><span class="tag">&lt;filter-name&gt;</span><span class="pln">springSessionRepositoryFilter</span><span class="tag">&lt;/filter-name&gt;</span><span class="pln">
	</span><span class="tag">&lt;url-pattern&gt;</span><span class="pln">/*</span><span class="tag">&lt;/url-pattern&gt;</span><span class="pln">
	</span><span class="tag">&lt;dispatcher&gt;</span><span class="pln">REQUEST</span><span class="tag">&lt;/dispatcher&gt;</span><span class="pln">
	</span><span class="tag">&lt;dispatcher&gt;</span><span class="pln">ERROR</span><span class="tag">&lt;/dispatcher&gt;</span><span class="pln">
</span><span class="tag">&lt;/filter-mapping&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <a href="https://docs.spring.io/spring-framework/docs/5.1.7.RELEASE/javadoc-api/org/springframework/web/filter/DelegatingFilterProxy.html"><code>DelegatingFilterProxy</code></a> looks up a Bean by the name of <code>springSessionRepositoryFilter</code> and cast it to a <code>Filter</code>.
For every request that <code>DelegatingFilterProxy</code> is invoked, the <code>springSessionRepositoryFilter</code> is invoked.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="httpsession-jdbc"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession-jdbc"></a>5.3. <code>HttpSession</code> with JDBC</h3>
<div class="paragraph">
<p>You can use Spring Session with <code>HttpSession</code> by adding a servlet filter before anything that uses the <code>HttpSession</code>.
You can choose to do in any of the following ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession-jdbc-jc">Java-based Configuration</a></p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession-jdbc-xml">XML-based Configuration</a></p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession-jdbc-boot">Spring Boot-based Configuration</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="httpsession-jdbc-jc"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession-jdbc-jc"></a>5.3.1. JDBC Java-based Configuration</h4>
<div class="paragraph">
<p>This section describes how to use a relational database to back <code>HttpSession</code> when you use Java-based configuration.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#samples">HttpSession JDBC Sample</a> provides a working sample of how to integrate Spring Session and <code>HttpSession</code> by using Java configuration.
You can read the basic steps for integration in the next few sections, but we encouraged you to follow along with the detailed HttpSession JDBC Guide when integrating with your own application.
</td>
</tr>
</tbody></table>
</div>
<div class="sect4">
<h5 id="httpsession-jdbc-spring-configuration"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession-jdbc-spring-configuration"></a>Spring Java Configuration</h5>
<div class="paragraph">
<p>After adding the required dependencies, we can create our Spring configuration.
The Spring configuration is responsible for creating a Servlet Filter that replaces the <code>HttpSession</code> implementation with an implementation backed by Spring Session.
To do so, add the following Spring Configuration:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="lit">@EnableJdbcHttpSession</span><span class="pln"> </span><i class="conum" data-value="1"></i><b><span class="pun">(</span><span class="lit">1</span><span class="pun">)</span></b><span class="pln">
</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Config</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

	</span><span class="lit">@Bean</span><span class="pln">
	</span><span class="kwd">public</span><span class="pln"> </span><span class="typ">EmbeddedDatabase</span><span class="pln"> dataSource</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">EmbeddedDatabaseBuilder</span><span class="pun">()</span><span class="pln"> </span><i class="conum" data-value="2"></i><b><span class="pun">(</span><span class="lit">2</span><span class="pun">)</span></b><span class="pln">
				</span><span class="pun">.</span><span class="pln">setType</span><span class="pun">(</span><span class="typ">EmbeddedDatabaseType</span><span class="pun">.</span><span class="pln">H2</span><span class="pun">)</span><span class="pln">
				</span><span class="pun">.</span><span class="pln">addScript</span><span class="pun">(</span><span class="str">"org/springframework/session/jdbc/schema-h2.sql"</span><span class="pun">).</span><span class="pln">build</span><span class="pun">();</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">

	</span><span class="lit">@Bean</span><span class="pln">
	</span><span class="kwd">public</span><span class="pln"> </span><span class="typ">PlatformTransactionManager</span><span class="pln"> transactionManager</span><span class="pun">(</span><span class="typ">DataSource</span><span class="pln"> dataSource</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">DataSourceTransactionManager</span><span class="pun">(</span><span class="pln">dataSource</span><span class="pun">);</span><span class="pln"> </span><i class="conum" data-value="3"></i><b><span class="pun">(</span><span class="lit">3</span><span class="pun">)</span></b><span class="pln">
	</span><span class="pun">}</span><span class="pln">

</span><span class="pun">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>@EnableJdbcHttpSession</code> annotation creates a Spring Bean with the name of <code>springSessionRepositoryFilter</code>.
That bean implements <code>Filter</code>.
The filter is in charge of replacing the <code>HttpSession</code> implementation to be backed by Spring Session.
In this instance, Spring Session is backed by a relational database.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We create a <code>dataSource</code> that connects Spring Session to an embedded instance of an H2 database.
We configure the H2 database to create database tables by using the SQL script that is included in Spring Session.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We create a <code>transactionManager</code> that manages transactions for previously configured <code>dataSource</code>.</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="paragraph">
<p>For additional information on how to configure data access related concerns, see the <a href="https://docs.spring.io/spring/docs/5.1.7.RELEASE/spring-framework-reference/data-access.html">Spring Framework Reference Documentation</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="java-servlet-container-initialization-2"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#java-servlet-container-initialization-2"></a>Java Servlet Container Initialization</h5>
<div class="paragraph">
<p>Our <a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession-spring-configuration">Spring Configuration</a> created a Spring bean named <code>springSessionRepositoryFilter</code> that implements <code>Filter</code>.
The <code>springSessionRepositoryFilter</code> bean is responsible for replacing the <code>HttpSession</code> with a custom implementation that is backed by Spring Session.</p>
</div>
<div class="paragraph">
<p>In order for our <code>Filter</code> to do its magic, Spring needs to load our <code>Config</code> class.
Last, we need to ensure that our Servlet Container (that is, Tomcat) uses our <code>springSessionRepositoryFilter</code> for every request.
Fortunately, Spring Session provides a utility class named <code>AbstractHttpSessionApplicationInitializer</code> to make both of these steps easy.
The following example shows how to do so:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="title">src/main/java/sample/Initializer.java</div>
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Initializer</span><span class="pln"> </span><span class="kwd">extends</span><span class="pln"> </span><span class="typ">AbstractHttpSessionApplicationInitializer</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><i class="conum" data-value="1"></i><b><span class="pun">(</span><span class="lit">1</span><span class="pun">)</span></b><span class="pln">

	</span><span class="kwd">public</span><span class="pln"> </span><span class="typ">Initializer</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">super</span><span class="pun">(</span><span class="typ">Config</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">);</span><span class="pln"> </span><i class="conum" data-value="2"></i><b><span class="pun">(</span><span class="lit">2</span><span class="pun">)</span></b><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The name of our class (Initializer) does not matter.
What is important is that we extend <code>AbstractHttpSessionApplicationInitializer</code>.
</td>
</tr>
</tbody></table>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The first step is to extend <code>AbstractHttpSessionApplicationInitializer</code>.
Doing so ensures that the Spring bean named <code>springSessionRepositoryFilter</code> is registered with our Servlet Container for every request.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>AbstractHttpSessionApplicationInitializer</code> also provides a mechanism to ensure Spring loads our <code>Config</code>.</td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="httpsession-jdbc-xml"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession-jdbc-xml"></a>5.3.2. JDBC XML-based Configuration</h4>
<div class="paragraph">
<p>This section describes how to use a relational database to back <code>HttpSession</code> when you use XML based configuration.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#samples">HttpSession JDBC XML Sample</a> provides a working sample of how to integrate Spring Session and <code>HttpSession</code> by using XML configuration.
You can read the basic steps for integration in the next few sections, but we encourage you to follow along with the detailed HttpSession JDBC XML Guide when integrating with your own application.
</td>
</tr>
</tbody></table>
</div>
<div class="sect4">
<h5 id="httpsession-jdbc-xml-spring-configuration"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession-jdbc-xml-spring-configuration"></a>Spring XML Configuration</h5>
<div class="paragraph">
<p>After adding the required dependencies, we can create our Spring configuration.
The Spring configuration is responsible for creating a servlet filter that replaces the <code>HttpSession</code> implementation with an implementation backed by Spring Session.
The following listing shows how to add the following Spring Configuration:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="title">src/main/webapp/WEB-INF/spring/session.xml</div>
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-xml" data-lang="xml"><i class="conum" data-value="1"></i><b><span class="pln">(1)</span></b><span class="pln">
</span><span class="tag">&lt;context:annotation-config/&gt;</span><span class="pln">
</span><span class="tag">&lt;bean</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"org.springframework.session.jdbc.config.annotation.web.http.JdbcHttpSessionConfiguration"</span><span class="tag">/&gt;</span><span class="pln">

</span><i class="conum" data-value="2"></i><b><span class="pln">(2)</span></b><span class="pln">
</span><span class="tag">&lt;jdbc:embedded-database</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">"dataSource"</span><span class="pln"> </span><span class="atn">database-name</span><span class="pun">=</span><span class="atv">"testdb"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"H2"</span><span class="tag">&gt;</span><span class="pln">
	</span><span class="tag">&lt;jdbc:script</span><span class="pln"> </span><span class="atn">location</span><span class="pun">=</span><span class="atv">"classpath:org/springframework/session/jdbc/schema-h2.sql"</span><span class="tag">/&gt;</span><span class="pln">
</span><span class="tag">&lt;/jdbc:embedded-database&gt;</span><span class="pln">

</span><i class="conum" data-value="3"></i><b><span class="pln">(3)</span></b><span class="pln">
</span><span class="tag">&lt;bean</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span><span class="tag">&gt;</span><span class="pln">
	</span><span class="tag">&lt;constructor-arg</span><span class="pln"> </span><span class="atn">ref</span><span class="pun">=</span><span class="atv">"dataSource"</span><span class="tag">/&gt;</span><span class="pln">
</span><span class="tag">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We use the combination of <code>&lt;context:annotation-config/&gt;</code> and <code>JdbcHttpSessionConfiguration</code> because Spring Session does not yet provide XML Namespace support (see <a href="https://github.com/spring-projects/spring-session/issues/104">gh-104</a>).
This creates a Spring bean with the name of <code>springSessionRepositoryFilter</code>.
That bean implements <code>Filter</code>.
The filter is in charge of replacing the <code>HttpSession</code> implementation to be backed by Spring Session.
In this instance, Spring Session is backed by a relational database.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We create a <code>dataSource</code> that connects Spring Session to an embedded instance of an H2 database.
We configure the H2 database to create database tables by using the SQL script that is included in Spring Session.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We create a <code>transactionManager</code> that manages transactions for previously configured <code>dataSource</code>.</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="paragraph">
<p>For additional information on how to configure data access-related concerns, see the <a href="https://docs.spring.io/spring/docs/5.1.7.RELEASE/spring-framework-reference/data-access.html">Spring Framework Reference Documentation</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="xml-servlet-container-initialization-2"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#xml-servlet-container-initialization-2"></a>XML Servlet Container Initialization</h5>
<div class="paragraph">
<p>Our <a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession-xml-spring-configuration">Spring Configuration</a> created a Spring bean named <code>springSessionRepositoryFilter</code> that implements <code>Filter</code>.
The <code>springSessionRepositoryFilter</code> bean is responsible for replacing the <code>HttpSession</code> with a custom implementation that is backed by Spring Session.</p>
</div>
<div class="paragraph">
<p>In order for our <code>Filter</code> to do its magic, we need to instruct Spring to load our <code>session.xml</code> configuration.
We do so with the following configuration:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="title">src/main/webapp/WEB-INF/web.xml</div>
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-xml" data-lang="xml"><span class="tag">&lt;context-param&gt;</span><span class="pln">
	</span><span class="tag">&lt;param-name&gt;</span><span class="pln">contextConfigLocation</span><span class="tag">&lt;/param-name&gt;</span><span class="pln">
	</span><span class="tag">&lt;param-value&gt;</span><span class="pln">
		/WEB-INF/spring/*.xml
	</span><span class="tag">&lt;/param-value&gt;</span><span class="pln">
</span><span class="tag">&lt;/context-param&gt;</span><span class="pln">
</span><span class="tag">&lt;listener&gt;</span><span class="pln">
	</span><span class="tag">&lt;listener-class&gt;</span><span class="pln">
		org.springframework.web.context.ContextLoaderListener
	</span><span class="tag">&lt;/listener-class&gt;</span><span class="pln">
</span><span class="tag">&lt;/listener&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <a href="https://docs.spring.io/spring/docs/5.1.7.RELEASE/spring-framework-reference/core.html#context-create"><code>ContextLoaderListener</code></a> reads the <code>contextConfigLocation</code> and picks up our session.xml configuration.</p>
</div>
<div class="paragraph">
<p>Last, we need to ensure that our Servlet Container (that is, Tomcat) uses our <code>springSessionRepositoryFilter</code> for every request.
The following snippet performs this last step for us:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="title">src/main/webapp/WEB-INF/web.xml</div>
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-xml" data-lang="xml"><span class="tag">&lt;filter&gt;</span><span class="pln">
	</span><span class="tag">&lt;filter-name&gt;</span><span class="pln">springSessionRepositoryFilter</span><span class="tag">&lt;/filter-name&gt;</span><span class="pln">
	</span><span class="tag">&lt;filter-class&gt;</span><span class="pln">org.springframework.web.filter.DelegatingFilterProxy</span><span class="tag">&lt;/filter-class&gt;</span><span class="pln">
</span><span class="tag">&lt;/filter&gt;</span><span class="pln">
</span><span class="tag">&lt;filter-mapping&gt;</span><span class="pln">
	</span><span class="tag">&lt;filter-name&gt;</span><span class="pln">springSessionRepositoryFilter</span><span class="tag">&lt;/filter-name&gt;</span><span class="pln">
	</span><span class="tag">&lt;url-pattern&gt;</span><span class="pln">/*</span><span class="tag">&lt;/url-pattern&gt;</span><span class="pln">
	</span><span class="tag">&lt;dispatcher&gt;</span><span class="pln">REQUEST</span><span class="tag">&lt;/dispatcher&gt;</span><span class="pln">
	</span><span class="tag">&lt;dispatcher&gt;</span><span class="pln">ERROR</span><span class="tag">&lt;/dispatcher&gt;</span><span class="pln">
</span><span class="tag">&lt;/filter-mapping&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <a href="https://docs.spring.io/spring-framework/docs/5.1.7.RELEASE/javadoc-api/org/springframework/web/filter/DelegatingFilterProxy.html"><code>DelegatingFilterProxy</code></a> looks up a bean named <code>springSessionRepositoryFilter</code> and casts it to a <code>Filter</code>.
For every request on which <code>DelegatingFilterProxy</code> is invoked, the <code>springSessionRepositoryFilter</code> is invoked.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="httpsession-jdbc-boot"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession-jdbc-boot"></a>5.3.3. JDBC Spring Boot-based Configuration</h4>
<div class="paragraph">
<p>This section describes how to use a relational database to back <code>HttpSession</code> when you use Spring Boot.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#samples">HttpSession JDBC Spring Boot Sample</a> provides a working sample of how to integrate Spring Session and <code>HttpSession</code> by using Spring Boot.
You can read the basic steps for integration in the next few sections, but we encourage you to follow along with the detailed HttpSession JDBC Spring Boot Guide when integrating with your own application.
</td>
</tr>
</tbody></table>
</div>
<div class="sect4">
<h5 id="httpsession-jdbc-boot-spring-configuration"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession-jdbc-boot-spring-configuration"></a>Spring Boot Configuration</h5>
<div class="paragraph">
<p>After adding the required dependencies, we can create our Spring Boot configuration.
Thanks to first-class auto configuration support, setting up Spring Session backed by a relational database is as simple as adding a single configuration property to your <code>application.properties</code>.
The following listing shows how to do so:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="title">src/main/resources/application.properties</div>
<div class="content">
<pre>spring.session.store-type=jdbc # Session store type.</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Under the hood, Spring Boot applies configuration that is equivalent to manually adding the <code>@EnableJdbcHttpSession</code> annotation.
This creates a Spring bean with the name of <code>springSessionRepositoryFilter</code>. That bean implements <code>Filter</code>.
The filter is in charge of replacing the <code>HttpSession</code> implementation to be backed by Spring Session.</p>
</div>
<div class="paragraph">
<p>You can further customize by using <code>application.properties</code>.
The following listing shows how to do so:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="title">src/main/resources/application.properties</div>
<div class="content">
<pre>server.servlet.session.timeout= # Session timeout. If a duration suffix is not specified, seconds are used.
spring.session.jdbc.initialize-schema=embedded # Database schema initialization mode.
spring.session.jdbc.schema=classpath:org/springframework/session/jdbc/schema-@@platform@@.sql # Path to the SQL file to use to initialize the database schema.
spring.session.jdbc.table-name=SPRING_SESSION # Name of the database table used to store sessions.</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>For more information, see the <a href="https://docs.spring.io/spring-boot/docs/2.1.4.RELEASE/reference/htmlsingle/#boot-features-session">Spring Session</a> portion of the Spring Boot documentation.</p>
</div>
</div>
<div class="sect4">
<h5 id="httpsession-jdbc-boot-configuration"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession-jdbc-boot-configuration"></a>Configuring the <code>DataSource</code></h5>
<div class="paragraph">
<p>Spring Boot automatically creates a <code>DataSource</code> that connects Spring Session to an embedded instance of an H2 database.
In a production environment, you need to update your configuration to point to your relational database.
For example, you can include the following in your application.properties:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="title">src/main/resources/application.properties</div>
<div class="content">
<pre>spring.datasource.url= # JDBC URL of the database.
spring.datasource.username= # Login username of the database.
spring.datasource.password= # Login password of the database.</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>For more information, see the <a href="https://docs.spring.io/spring-boot/docs/2.1.4.RELEASE/reference/htmlsingle/#boot-features-configure-datasource">Configure a DataSource</a> portion of the Spring Boot documentation.</p>
</div>
</div>
<div class="sect4">
<h5 id="httpsession-jdbc-boot-servlet-configuration"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession-jdbc-boot-servlet-configuration"></a>Servlet Container Initialization</h5>
<div class="paragraph">
<p>Our <a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession-jdbc-boot-spring-configuration">Spring Boot Configuration</a> created a Spring bean named <code>springSessionRepositoryFilter</code> that implements <code>Filter</code>.
The <code>springSessionRepositoryFilter</code> bean is responsible for replacing the <code>HttpSession</code> with a custom implementation that is backed by Spring Session.</p>
</div>
<div class="paragraph">
<p>In order for our <code>Filter</code> to do its magic, Spring needs to load our <code>Config</code> class.
Last, we need to ensure that our Servlet Container (that is, Tomcat) uses our <code>springSessionRepositoryFilter</code> for every request.
Fortunately, Spring Boot takes care of both of these steps for us.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="httpsession-hazelcast"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession-hazelcast"></a>5.4. HttpSession with Hazelcast</h3>
<div class="paragraph">
<p>Using Spring Session with <code>HttpSession</code> is enabled by adding a Servlet Filter before anything that uses the <code>HttpSession</code>.</p>
</div>
<div class="paragraph">
<p>This section describes how to use Hazelcast to back <code>HttpSession</code> by using Java-based configuration.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#samples">Hazelcast Spring Sample</a> provides a working sample of how to integrate Spring Session and <code>HttpSession</code> by using Java configuration.
You can read the basic steps for integration in the next few sections, but we encourage you to follow along with the detailed Hazelcast Spring Guide when integrating with your own application.
</td>
</tr>
</tbody></table>
</div>
<div class="sect3">
<h4 id="security-spring-configuration"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#security-spring-configuration"></a>5.4.1. Spring Configuration</h4>
<div class="paragraph">
<p>After adding the required dependencies, we can create our Spring configuration.
The Spring configuration is responsible for creating a servlet filter that replaces the <code>HttpSession</code> implementation with an implementation backed by Spring Session.
To do so, add the following Spring Configuration:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="lit">@EnableHazelcastHttpSession</span><span class="pln"> </span><i class="conum" data-value="1"></i><b><span class="pun">(</span><span class="lit">1</span><span class="pun">)</span></b><span class="pln">
</span><span class="lit">@Configuration</span><span class="pln">
</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">HazelcastHttpSessionConfig</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

	</span><span class="lit">@Bean</span><span class="pln">
	</span><span class="kwd">public</span><span class="pln"> </span><span class="typ">HazelcastInstance</span><span class="pln"> hazelcastInstance</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="typ">MapAttributeConfig</span><span class="pln"> attributeConfig </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">MapAttributeConfig</span><span class="pun">()</span><span class="pln">
				</span><span class="pun">.</span><span class="pln">setName</span><span class="pun">(</span><span class="typ">HazelcastSessionRepository</span><span class="pun">.</span><span class="pln">PRINCIPAL_NAME_ATTRIBUTE</span><span class="pun">)</span><span class="pln">
				</span><span class="pun">.</span><span class="pln">setExtractor</span><span class="pun">(</span><span class="typ">PrincipalNameExtractor</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">.</span><span class="pln">getName</span><span class="pun">());</span><span class="pln">

		</span><span class="typ">Config</span><span class="pln"> config </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Config</span><span class="pun">();</span><span class="pln">

		config</span><span class="pun">.</span><span class="pln">getMapConfig</span><span class="pun">(</span><span class="typ">HazelcastSessionRepository</span><span class="pun">.</span><span class="pln">DEFAULT_SESSION_MAP_NAME</span><span class="pun">)</span><span class="pln"> </span><i class="conum" data-value="2"></i><b><span class="pun">(</span><span class="lit">2</span><span class="pun">)</span></b><span class="pln">
				</span><span class="pun">.</span><span class="pln">addMapAttributeConfig</span><span class="pun">(</span><span class="pln">attributeConfig</span><span class="pun">)</span><span class="pln">
				</span><span class="pun">.</span><span class="pln">addMapIndexConfig</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">MapIndexConfig</span><span class="pun">(</span><span class="pln">
						</span><span class="typ">HazelcastSessionRepository</span><span class="pun">.</span><span class="pln">PRINCIPAL_NAME_ATTRIBUTE</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">));</span><span class="pln">

		</span><span class="kwd">return</span><span class="pln"> </span><span class="typ">Hazelcast</span><span class="pun">.</span><span class="pln">newHazelcastInstance</span><span class="pun">(</span><span class="pln">config</span><span class="pun">);</span><span class="pln"> </span><i class="conum" data-value="3"></i><b><span class="pun">(</span><span class="lit">3</span><span class="pun">)</span></b><span class="pln">
	</span><span class="pun">}</span><span class="pln">

</span><span class="pun">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>@EnableHazelcastHttpSession</code> annotation creates a Spring bean named <code>springSessionRepositoryFilter</code> that implements <code>Filter</code>.
The filter is in charge of replacing the <code>HttpSession</code> implementation to be backed by Spring Session.
In this instance, Spring Session is backed by Hazelcast.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>In order to support retrieval of sessions by principal name index, an appropriate <code>ValueExtractor</code> needs to be registered.
Spring Session provides <code>PrincipalNameExtractor</code> for this purpose.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We create a <code>HazelcastInstance</code> that connects Spring Session to Hazelcast.
By default, the application starts and connects to an embedded instance of Hazelcast.
For more information on configuring Hazelcast, see the <a href="https://docs.hazelcast.org/docs/3.11.4/manual/html-single/index.html#hazelcast-configuration">reference documentation</a>.</td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="servlet-container-initialization"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#servlet-container-initialization"></a>5.4.2. Servlet Container Initialization</h4>
<div class="paragraph">
<p>Our <a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#security-spring-configuration">Spring Configuration</a> created a Spring bean named <code>springSessionRepositoryFilter</code> that implements <code>Filter</code>.
The <code>springSessionRepositoryFilter</code> bean is responsible for replacing the <code>HttpSession</code> with a custom implementation that is backed by Spring Session.</p>
</div>
<div class="paragraph">
<p>In order for our <code>Filter</code> to do its magic, Spring needs to load our <code>SessionConfig</code> class.
Since our application is already loading Spring configuration by using our <code>SecurityInitializer</code> class, we can add our <code>SessionConfig</code> class to it.
The following listing shows how to do so:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="title">src/main/java/sample/SecurityInitializer.java</div>
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">SecurityInitializer</span><span class="pln"> </span><span class="kwd">extends</span><span class="pln"> </span><span class="typ">AbstractSecurityWebApplicationInitializer</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

	</span><span class="kwd">public</span><span class="pln"> </span><span class="typ">SecurityInitializer</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">super</span><span class="pun">(</span><span class="typ">SecurityConfig</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">,</span><span class="pln"> </span><span class="typ">SessionConfig</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Last, we need to ensure that our Servlet Container (that is, Tomcat) uses our <code>springSessionRepositoryFilter</code> for every request.
It is extremely important that Spring Session’s <code>springSessionRepositoryFilter</code> is invoked before Spring Security’s <code>springSecurityFilterChain</code>.
Doing so ensures that the <code>HttpSession</code> that Spring Security uses is backed by Spring Session.
Fortunately, Spring Session provides a utility class named <code>AbstractHttpSessionApplicationInitializer</code> that makes this doing so easy.
The following example shows how to do so:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="title">src/main/java/sample/Initializer.java</div>
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Initializer</span><span class="pln"> </span><span class="kwd">extends</span><span class="pln"> </span><span class="typ">AbstractHttpSessionApplicationInitializer</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

</span><span class="pun">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The name of our class (<code>Initializer</code>) does not matter. What is important is that we extend <code>AbstractHttpSessionApplicationInitializer</code>.
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>By extending <code>AbstractHttpSessionApplicationInitializer</code>, we ensure that the Spring Bean named <code>springSessionRepositoryFilter</code> is registered with our servlet container for every request before Spring Security’s <code>springSecurityFilterChain</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="httpsession-how"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession-how"></a>5.5. How <code>HttpSession</code> Integration Works</h3>
<div class="paragraph">
<p>Fortunately, both <code>HttpSession</code> and <code>HttpServletRequest</code> (the API for obtaining an <code>HttpSession</code>) are both interfaces.
This means that we can provide our own implementations for each of these APIs.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This section describes how Spring Session provides transparent integration with <code>HttpSession</code>. We offer this content so that you can understand what is happening under the covers. This functionality is already integrated and you do NOT need to implement this logic yourself.
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>First, we create a custom <code>HttpServletRequest</code> that returns a custom implementation of <code>HttpSession</code>.
It looks something like the following:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">SessionRepositoryRequestWrapper</span><span class="pln"> </span><span class="kwd">extends</span><span class="pln"> </span><span class="typ">HttpServletRequestWrapper</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

	</span><span class="kwd">public</span><span class="pln"> </span><span class="typ">SessionRepositoryRequestWrapper</span><span class="pun">(</span><span class="typ">HttpServletRequest</span><span class="pln"> original</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">super</span><span class="pun">(</span><span class="pln">original</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">

	</span><span class="kwd">public</span><span class="pln"> </span><span class="typ">HttpSession</span><span class="pln"> getSession</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> getSession</span><span class="pun">(</span><span class="kwd">true</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">

	</span><span class="kwd">public</span><span class="pln"> </span><span class="typ">HttpSession</span><span class="pln"> getSession</span><span class="pun">(</span><span class="kwd">boolean</span><span class="pln"> createNew</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="com">// create an HttpSession implementation from Spring Session</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">

	</span><span class="com">// ... other methods delegate to the original HttpServletRequest ...</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Any method that returns an <code>HttpSession</code> is overridden.
All other methods are implemented by <code>HttpServletRequestWrapper</code> and delegate to the original <code>HttpServletRequest</code> implementation.</p>
</div>
<div class="paragraph">
<p>We replace the <code>HttpServletRequest</code> implementation by using a servlet <code>Filter</code> called <code>SessionRepositoryFilter</code>.
The pseudocode belows:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">SessionRepositoryFilter</span><span class="pln"> </span><span class="kwd">implements</span><span class="pln"> </span><span class="typ">Filter</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

	</span><span class="kwd">public</span><span class="pln"> doFilter</span><span class="pun">(</span><span class="typ">ServletRequest</span><span class="pln"> request</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ServletResponse</span><span class="pln"> response</span><span class="pun">,</span><span class="pln"> </span><span class="typ">FilterChain</span><span class="pln"> chain</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="typ">HttpServletRequest</span><span class="pln"> httpRequest </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">HttpServletRequest</span><span class="pun">)</span><span class="pln"> request</span><span class="pun">;</span><span class="pln">
		</span><span class="typ">SessionRepositoryRequestWrapper</span><span class="pln"> customRequest </span><span class="pun">=</span><span class="pln">
			</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SessionRepositoryRequestWrapper</span><span class="pun">(</span><span class="pln">httpRequest</span><span class="pun">);</span><span class="pln">

		chain</span><span class="pun">.</span><span class="pln">doFilter</span><span class="pun">(</span><span class="pln">customRequest</span><span class="pun">,</span><span class="pln"> response</span><span class="pun">,</span><span class="pln"> chain</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">

	</span><span class="com">// ...</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>By passing a custom <code>HttpServletRequest</code> implementation into the <code>FilterChain</code>, we ensure that anything invoked after our <code>Filter</code> uses the custom <code>HttpSession</code> implementation.
This highlights why it is important that Spring Session’s <code>SessionRepositoryFilter</code> be placed before anything that interacts with the <code>HttpSession</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="httpsession-rest"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession-rest"></a>5.6. <code>HttpSession</code> and RESTful APIs</h3>
<div class="paragraph">
<p>Spring Session can work with RESTful APIs by letting the session be provided in a header.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#samples">REST Sample</a> provides a working sample of how to use Spring Session in a REST application to support authenticating with a header.
You can follow the basic steps for integration described in the next few sections, but we encourage you to follow along with the detailed REST Guide when integrating with your own application.
</td>
</tr>
</tbody></table>
</div>
<div class="sect3">
<h4 id="rest-spring-configuration"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#rest-spring-configuration"></a>5.6.1. Spring Configuration</h4>
<div class="paragraph">
<p>After adding the required dependencies, we can create our Spring configuration.
The Spring configuration is responsible for creating a servlet filter that replaces the <code>HttpSession</code> implementation with an implementation backed by Spring Session.
To do so, add the following Spring Configuration:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="lit">@Configuration</span><span class="pln">
</span><span class="lit">@EnableRedisHttpSession</span><span class="pln"> </span><i class="conum" data-value="1"></i><b><span class="pun">(</span><span class="lit">1</span><span class="pun">)</span></b><span class="pln">
</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">HttpSessionConfig</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

	</span><span class="lit">@Bean</span><span class="pln">
	</span><span class="kwd">public</span><span class="pln"> </span><span class="typ">LettuceConnectionFactory</span><span class="pln"> connectionFactory</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">LettuceConnectionFactory</span><span class="pun">();</span><span class="pln"> </span><i class="conum" data-value="2"></i><b><span class="pun">(</span><span class="lit">2</span><span class="pun">)</span></b><span class="pln">
	</span><span class="pun">}</span><span class="pln">

	</span><span class="lit">@Bean</span><span class="pln">
	</span><span class="kwd">public</span><span class="pln"> </span><span class="typ">HttpSessionIdResolver</span><span class="pln"> httpSessionIdResolver</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> </span><span class="typ">HeaderHttpSessionIdResolver</span><span class="pun">.</span><span class="pln">xAuthToken</span><span class="pun">();</span><span class="pln"> </span><i class="conum" data-value="3"></i><b><span class="pun">(</span><span class="lit">3</span><span class="pun">)</span></b><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>@EnableRedisHttpSession</code> annotation creates a Spring bean named <code>springSessionRepositoryFilter</code> that implements <code>Filter</code>.
The filter is in charge of replacing the <code>HttpSession</code> implementation to be backed by Spring Session.
In this instance, Spring Session is backed by Redis.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We create a <code>RedisConnectionFactory</code> that connects Spring Session to the Redis Server.
We configure the connection to connect to localhost on the default port (6379).
For more information on configuring Spring Data Redis, see the <a href="https://docs.spring.io/spring-data/data-redis/docs/2.1.8.RELEASE/reference/html/">reference documentation</a>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We customize Spring Session’s HttpSession integration to use HTTP headers to convey the current session information instead of cookies.</td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="servlet-container-initialization-2"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#servlet-container-initialization-2"></a>5.6.2. Servlet Container Initialization</h4>
<div class="paragraph">
<p>Our <a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#rest-spring-configuration">Spring Configuration</a> created a Spring Bean named <code>springSessionRepositoryFilter</code> that implements <code>Filter</code>.
The <code>springSessionRepositoryFilter</code> bean is responsible for replacing the <code>HttpSession</code> with a custom implementation that is backed by Spring Session.</p>
</div>
<div class="paragraph">
<p>In order for our <code>Filter</code> to do its magic, Spring needs to load our <code>Config</code> class.
We provide the configuration in our Spring <code>MvcInitializer</code>, as the following example shows:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="title">src/main/java/sample/mvc/MvcInitializer.java</div>
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="lit">@Override</span><span class="pln">
</span><span class="kwd">protected</span><span class="pln"> </span><span class="typ">Class</span><span class="pun">&lt;?&gt;[]</span><span class="pln"> getRootConfigClasses</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Class</span><span class="pun">[]</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">SecurityConfig</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">,</span><span class="pln"> </span><span class="typ">HttpSessionConfig</span><span class="pun">.</span><span class="kwd">class</span><span class="pln"> </span><span class="pun">};</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Last, we need to ensure that our Servlet Container (that is, Tomcat) uses our <code>springSessionRepositoryFilter</code> for every request.
Fortunately, Spring Session provides a utility class named <code>AbstractHttpSessionApplicationInitializer</code> that makes doing so easy. To do so, extend the class with the default constructor, as the following example shows:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="title">src/main/java/sample/Initializer.java</div>
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Initializer</span><span class="pln"> </span><span class="kwd">extends</span><span class="pln"> </span><span class="typ">AbstractHttpSessionApplicationInitializer</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

</span><span class="pun">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The name of our class (<code>Initializer</code>) does not matter. What is important is that we extend <code>AbstractHttpSessionApplicationInitializer</code>.
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="httpsession-httpsessionlistener"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession-httpsessionlistener"></a>5.7. Using <code>HttpSessionListener</code></h3>
<div class="paragraph">
<p>Spring Session supports <code>HttpSessionListener</code> by translating <code>SessionDestroyedEvent</code> and <code>SessionCreatedEvent</code> into <code>HttpSessionEvent</code> by declaring <code>SessionEventHttpSessionListenerAdapter</code>.
To use this support, you need to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Ensure your <code>SessionRepository</code> implementation supports and is configured to fire <code>SessionDestroyedEvent</code> and <code>SessionCreatedEvent</code>.</p>
</li>
<li>
<p>Configure <code>SessionEventHttpSessionListenerAdapter</code> as a Spring bean.</p>
</li>
<li>
<p>Inject every <code>HttpSessionListener</code> into the <code>SessionEventHttpSessionListenerAdapter</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you use the configuration support documented in <a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession-redis"><code>HttpSession</code> with Redis</a>, all you need to do is register every <code>HttpSessionListener</code> as a bean.
For example, assume you want to support Spring Security’s concurrency control and need to use <code>HttpSessionEventPublisher</code>. In that case, you can add <code>HttpSessionEventPublisher</code> as a bean.
In Java configuration, this might look like the following:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="lit">@Configuration</span><span class="pln">
</span><span class="lit">@EnableRedisHttpSession</span><span class="pln">
</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">RedisHttpSessionConfig</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

	</span><span class="lit">@Bean</span><span class="pln">
	</span><span class="kwd">public</span><span class="pln"> </span><span class="typ">HttpSessionEventPublisher</span><span class="pln"> httpSessionEventPublisher</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">HttpSessionEventPublisher</span><span class="pun">();</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">

	</span><span class="com">// ...</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In XML configuration, this might look like the following:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-xml" data-lang="xml"><span class="tag">&lt;bean</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"org.springframework.security.web.session.HttpSessionEventPublisher"</span><span class="tag">/&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="websocket"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#websocket"></a>6. WebSocket Integration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Session provides transparent integration with Spring’s WebSocket support.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Spring Session’s WebSocket support works only with Spring’s WebSocket support.
Specifically,it does not work with using <a href="https://www.jcp.org/en/jsr/detail?id=356">JSR-356</a> directly, because JSR-356 does not have a mechanism for intercepting incoming WebSocket messages.
</td>
</tr>
</tbody></table>
</div>
<div class="sect2">
<h3 id="websocket-why"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#websocket-why"></a>6.1. Why Spring Session and WebSockets?</h3>
<div class="paragraph">
<p>So why do we need Spring Session when we use WebSockets?</p>
</div>
<div class="paragraph">
<p>Consider an email application that does much of its work through HTTP requests.
However, there is also a chat application embedded within it that works over WebSocket APIs.
If a user is actively chatting with someone, we should not timeout the <code>HttpSession</code>, since this would be a pretty poor user experience.
However, this is exactly what <a href="https://java.net/jira/browse/WEBSOCKET_SPEC-175">JSR-356</a> does.</p>
</div>
<div class="paragraph">
<p>Another issue is that, according to JSR-356, if the <code>HttpSession</code> times out, any WebSocket that was created with that <code>HttpSession</code> and an authenticated user should be forcibly closed.
This means that, if we are actively chatting in our application and are not using the HttpSession, we also do disconnect from our conversation.</p>
</div>
</div>
<div class="sect2">
<h3 id="websocket-usage"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#websocket-usage"></a>6.2. WebSocket Usage</h3>
<div class="paragraph">
<p>The <a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#samples">WebSocket Sample</a> provides a working sample of how to integrate Spring Session with WebSockets.
You can follow the basic steps for integration described in the next few headings, but we encourage you to follow along with the detailed WebSocket Guide when integrating with your own application.</p>
</div>
<div class="sect3">
<h4 id="websocket-httpsession"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#websocket-httpsession"></a>6.2.1. <code>HttpSession</code> Integration</h4>
<div class="paragraph">
<p>Before using WebSocket integration, you should be sure that you have <a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession"><code>HttpSession</code> Integration</a> working first.</p>
</div>
</div>
<div class="sect3">
<h4 id="websocket-spring-configuration"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#websocket-spring-configuration"></a>6.2.2. Spring Configuration</h4>
<div class="paragraph">
<p>In a typical Spring WebSocket application, you would implement <code>WebSocketMessageBrokerConfigurer</code>.
For example, the configuration might look something like the following:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="lit">@Configuration</span><span class="pln">
</span><span class="lit">@EnableScheduling</span><span class="pln">
</span><span class="lit">@EnableWebSocketMessageBroker</span><span class="pln">
</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">WebSocketConfig</span><span class="pln"> </span><span class="kwd">implements</span><span class="pln"> </span><span class="typ">WebSocketMessageBrokerConfigurer</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

	</span><span class="lit">@Override</span><span class="pln">
	</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> registerStompEndpoints</span><span class="pun">(</span><span class="typ">StompEndpointRegistry</span><span class="pln"> registry</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		registry</span><span class="pun">.</span><span class="pln">addEndpoint</span><span class="pun">(</span><span class="str">"/messages"</span><span class="pun">).</span><span class="pln">withSockJS</span><span class="pun">();</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">

	</span><span class="lit">@Override</span><span class="pln">
	</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> configureMessageBroker</span><span class="pun">(</span><span class="typ">MessageBrokerRegistry</span><span class="pln"> registry</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		registry</span><span class="pun">.</span><span class="pln">enableSimpleBroker</span><span class="pun">(</span><span class="str">"/queue/"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"/topic/"</span><span class="pun">);</span><span class="pln">
		registry</span><span class="pun">.</span><span class="pln">setApplicationDestinationPrefixes</span><span class="pun">(</span><span class="str">"/app"</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>We can update our configuration to use Spring Session’s WebSocket support.
The following example shows how to do so:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="title">src/main/java/samples/config/WebSocketConfig.java</div>
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="lit">@Configuration</span><span class="pln">
</span><span class="lit">@EnableScheduling</span><span class="pln">
</span><span class="lit">@EnableWebSocketMessageBroker</span><span class="pln">
</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">WebSocketConfig</span><span class="pln">
		</span><span class="kwd">extends</span><span class="pln"> </span><span class="typ">AbstractSessionWebSocketMessageBrokerConfigurer</span><span class="pun">&lt;</span><span class="typ">Session</span><span class="pun">&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><i class="conum" data-value="1"></i><b><span class="pun">(</span><span class="lit">1</span><span class="pun">)</span></b><span class="pln">

	</span><span class="lit">@Override</span><span class="pln">
	</span><span class="kwd">protected</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> configureStompEndpoints</span><span class="pun">(</span><span class="typ">StompEndpointRegistry</span><span class="pln"> registry</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><i class="conum" data-value="2"></i><b><span class="pun">(</span><span class="lit">2</span><span class="pun">)</span></b><span class="pln">
		registry</span><span class="pun">.</span><span class="pln">addEndpoint</span><span class="pun">(</span><span class="str">"/messages"</span><span class="pun">).</span><span class="pln">withSockJS</span><span class="pun">();</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">

	</span><span class="lit">@Override</span><span class="pln">
	</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> configureMessageBroker</span><span class="pun">(</span><span class="typ">MessageBrokerRegistry</span><span class="pln"> registry</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		registry</span><span class="pun">.</span><span class="pln">enableSimpleBroker</span><span class="pun">(</span><span class="str">"/queue/"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"/topic/"</span><span class="pun">);</span><span class="pln">
		registry</span><span class="pun">.</span><span class="pln">setApplicationDestinationPrefixes</span><span class="pun">(</span><span class="str">"/app"</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To hook in the Spring Session support we only need to change two things:</p>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Instead of implementing <code>WebSocketMessageBrokerConfigurer</code>, we extend <code>AbstractSessionWebSocketMessageBrokerConfigurer</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We rename the <code>registerStompEndpoints</code> method to <code>configureStompEndpoints</code></td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="paragraph">
<p>What does <code>AbstractSessionWebSocketMessageBrokerConfigurer</code> do behind the scenes?</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>WebSocketConnectHandlerDecoratorFactory</code> is added as a <code>WebSocketHandlerDecoratorFactory</code> to <code>WebSocketTransportRegistration</code>.
This ensures a custom <code>SessionConnectEvent</code> is fired that contains the <code>WebSocketSession</code>.
The <code>WebSocketSession</code> is necessary to terminate any WebSocket connections that are still open when a Spring Session is terminated.</p>
</li>
<li>
<p><code>SessionRepositoryMessageInterceptor</code> is added as a <code>HandshakeInterceptor</code> to every <code>StompWebSocketEndpointRegistration</code>.
This ensures that the <code>Session</code> is added to the WebSocket properties to enable updating the last accessed time.</p>
</li>
<li>
<p><code>SessionRepositoryMessageInterceptor</code> is added as a <code>ChannelInterceptor</code> to our inbound <code>ChannelRegistration</code>.
This ensures that every time an inbound message is received, that the last accessed time of our Spring Session is updated.</p>
</li>
<li>
<p><code>WebSocketRegistryListener</code> is created as a Spring bean.
This ensures that we have a mapping of all of the <code>Session</code> IDs to the corresponding WebSocket connections.
By maintaining this mapping, we can close all the WebSocket connections when a Spring Session (HttpSession) is terminated.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="websession"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#websession"></a>7. WebSession Integration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Session provides transparent integration with Spring WebFlux’s <code>WebSession</code>.
This means that you can switch the <code>WebSession</code> implementation out with an implementation that is backed by Spring Session.</p>
</div>
<div class="sect2">
<h3 id="websession-why"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#websession-why"></a>7.1. Why Spring Session and WebSession?</h3>
<div class="paragraph">
<p>We have already mentioned that Spring Session provides transparent integration with Spring WebFlux’s <code>WebSession</code>, but what benefits do we get out of this?
As with <code>HttpSession</code>, Spring Session makes it trivial to support <a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#websession-redis">clustered sessions</a> without being tied to an application container specific solution.</p>
</div>
</div>
<div class="sect2">
<h3 id="websession-redis"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#websession-redis"></a>7.2. WebSession with Redis</h3>
<div class="paragraph">
<p>Using Spring Session with <code>WebSession</code> is enabled by registering a <code>WebSessionManager</code> implementation backed by Spring Session’s <code>ReactiveSessionRepository</code>.
The Spring configuration is responsible for creating a <code>WebSessionManager</code> that replaces the <code>WebSession</code> implementation with an implementation backed by Spring Session.
To do so, add the following Spring Configuration:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="lit">@EnableRedisWebSession</span><span class="pln"> </span><i class="conum" data-value="1"></i><b><span class="pun">(</span><span class="lit">1</span><span class="pun">)</span></b><span class="pln">
</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">SessionConfiguration</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

	</span><span class="lit">@Bean</span><span class="pln">
	</span><span class="kwd">public</span><span class="pln"> </span><span class="typ">LettuceConnectionFactory</span><span class="pln"> redisConnectionFactory</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">LettuceConnectionFactory</span><span class="pun">();</span><span class="pln"> </span><i class="conum" data-value="2"></i><b><span class="pun">(</span><span class="lit">2</span><span class="pun">)</span></b><span class="pln">
	</span><span class="pun">}</span><span class="pln">

</span><span class="pun">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>@EnableRedisWebSession</code> annotation creates a Spring bean with the name of <code>webSessionManager</code>. That bean implements the <code>WebSessionManager</code>.
This is what is in charge of replacing the <code>WebSession</code> implementation to be backed by Spring Session.
In this instance, Spring Session is backed by Redis.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We create a <code>RedisConnectionFactory</code> that connects Spring Session to the Redis Server.
We configure the connection to connect to localhost on the default port (6379)
For more information on configuring Spring Data Redis, see the <a href="https://docs.spring.io/spring-data/data-redis/docs/2.1.8.RELEASE/reference/html/">reference documentation</a>.</td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="websession-how"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#websession-how"></a>7.3. How WebSession Integration Works</h3>
<div class="paragraph">
<p>It is considerably easier for Spring Session to integrate with Spring WebFlux and its <code>WebSession</code>, compared to Servlet API and its <code>HttpSession</code>.
Spring WebFlux provides the <code>WebSessionStore</code> API, which presents a strategy for persisting <code>WebSession</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This section describes how Spring Session provides transparent integration with <code>WebSession</code>. We offer this content so that you can understand what is happening under the covers. This functionality is already integrated and you do NOT need to implement this logic yourself.
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>First, we create a custom <code>SpringSessionWebSession</code> that delegates to Spring Session’s <code>Session</code>.
It looks something like the following:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">SpringSessionWebSession</span><span class="pln"> </span><span class="kwd">implements</span><span class="pln"> </span><span class="typ">WebSession</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

	</span><span class="kwd">enum</span><span class="pln"> </span><span class="typ">State</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		NEW</span><span class="pun">,</span><span class="pln"> STARTED
	</span><span class="pun">}</span><span class="pln">

	</span><span class="kwd">private</span><span class="pln"> </span><span class="kwd">final</span><span class="pln"> S session</span><span class="pun">;</span><span class="pln">

	</span><span class="kwd">private</span><span class="pln"> </span><span class="typ">AtomicReference</span><span class="pun">&lt;</span><span class="typ">State</span><span class="pun">&gt;</span><span class="pln"> state </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">AtomicReference</span><span class="pun">&lt;&gt;();</span><span class="pln">

	</span><span class="typ">SpringSessionWebSession</span><span class="pun">(</span><span class="pln">S session</span><span class="pun">,</span><span class="pln"> </span><span class="typ">State</span><span class="pln"> state</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">session </span><span class="pun">=</span><span class="pln"> session</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">state</span><span class="pun">.</span><span class="pln">set</span><span class="pun">(</span><span class="pln">state</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">

	</span><span class="lit">@Override</span><span class="pln">
	</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> start</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">state</span><span class="pun">.</span><span class="pln">compareAndSet</span><span class="pun">(</span><span class="typ">State</span><span class="pun">.</span><span class="pln">NEW</span><span class="pun">,</span><span class="pln"> </span><span class="typ">State</span><span class="pun">.</span><span class="pln">STARTED</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">

	</span><span class="lit">@Override</span><span class="pln">
	</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">boolean</span><span class="pln"> isStarted</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="typ">State</span><span class="pln"> value </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">state</span><span class="pun">.</span><span class="pln">get</span><span class="pun">();</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="typ">State</span><span class="pun">.</span><span class="pln">STARTED</span><span class="pun">.</span><span class="pln">equals</span><span class="pun">(</span><span class="pln">value</span><span class="pun">)</span><span class="pln">
				</span><span class="pun">||</span><span class="pln"> </span><span class="pun">(</span><span class="typ">State</span><span class="pun">.</span><span class="pln">NEW</span><span class="pun">.</span><span class="pln">equals</span><span class="pun">(</span><span class="pln">value</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> </span><span class="pun">!</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">session</span><span class="pun">.</span><span class="pln">getAttributes</span><span class="pun">().</span><span class="pln">isEmpty</span><span class="pun">()));</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">

	</span><span class="lit">@Override</span><span class="pln">
	</span><span class="kwd">public</span><span class="pln"> </span><span class="typ">Mono</span><span class="pun">&lt;</span><span class="typ">Void</span><span class="pun">&gt;</span><span class="pln"> changeSessionId</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> </span><span class="typ">Mono</span><span class="pun">.</span><span class="pln">defer</span><span class="pun">(()</span><span class="pln"> </span><span class="pun">-&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">session</span><span class="pun">.</span><span class="pln">changeSessionId</span><span class="pun">();</span><span class="pln">
			</span><span class="kwd">return</span><span class="pln"> save</span><span class="pun">();</span><span class="pln">
		</span><span class="pun">});</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">

	</span><span class="com">// ... other methods delegate to the original Session</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Next, we create a custom <code>WebSessionStore</code> that delegates to the <code>ReactiveSessionRepository</code> and wraps <code>Session</code> into custom <code>WebSession</code> implementation, as the following listing shows:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">SpringSessionWebSessionStore</span><span class="pun">&lt;</span><span class="pln">S </span><span class="kwd">extends</span><span class="pln"> </span><span class="typ">Session</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">implements</span><span class="pln"> </span><span class="typ">WebSessionStore</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

	</span><span class="kwd">private</span><span class="pln"> </span><span class="kwd">final</span><span class="pln"> </span><span class="typ">ReactiveSessionRepository</span><span class="pun">&lt;</span><span class="pln">S</span><span class="pun">&gt;</span><span class="pln"> sessions</span><span class="pun">;</span><span class="pln">

	</span><span class="kwd">public</span><span class="pln"> </span><span class="typ">SpringSessionWebSessionStore</span><span class="pun">(</span><span class="typ">ReactiveSessionRepository</span><span class="pun">&lt;</span><span class="pln">S</span><span class="pun">&gt;</span><span class="pln"> reactiveSessionRepository</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">sessions </span><span class="pun">=</span><span class="pln"> reactiveSessionRepository</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">

	</span><span class="com">// ...</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>To be detected by Spring WebFlux, this custom <code>WebSessionStore</code> needs to be registered with <code>ApplicationContext</code> as a bean named <code>webSessionManager</code>.
For additional information on Spring WebFlux, see the <a href="https://docs.spring.io/spring/docs/5.1.7.RELEASE/spring-framework-reference/web-reactive.html">Spring Framework Reference Documentation</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spring-security"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#spring-security"></a>8. Spring Security Integration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Session provides integration with Spring Security.</p>
</div>
<div class="sect2">
<h3 id="spring-security-rememberme"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#spring-security-rememberme"></a>8.1. Spring Security Remember-me Support</h3>
<div class="paragraph">
<p>Spring Session provides integration with <a href="https://docs.spring.io/spring-security/site/docs/5.1.5.RELEASE/reference/htmlsingle/#remember-me">Spring Security’s Remember-me Authentication</a>.
The support:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Changes the session expiration length</p>
</li>
<li>
<p>Ensures that the session cookie expires at <code>Integer.MAX_VALUE</code>.
The cookie expiration is set to the largest possible value, because the cookie is set only when the session is created.
If it were set to the same value as the session expiration, the session would get renewed when the user used it but the cookie expiration would not be updated (causing the expiration to be fixed).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To configure Spring Session with Spring Security in Java Configuration, you can use the following listing as a guide:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="lit">@Override</span><span class="pln">
</span><span class="kwd">protected</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> configure</span><span class="pun">(</span><span class="typ">HttpSecurity</span><span class="pln"> http</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">throws</span><span class="pln"> </span><span class="typ">Exception</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	http
		</span><span class="com">// ... additional configuration ...</span><span class="pln">
		</span><span class="pun">.</span><span class="pln">rememberMe</span><span class="pun">()</span><span class="pln">
			</span><span class="pun">.</span><span class="pln">rememberMeServices</span><span class="pun">(</span><span class="pln">rememberMeServices</span><span class="pun">());</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="lit">@Bean</span><span class="pln">
</span><span class="kwd">public</span><span class="pln"> </span><span class="typ">SpringSessionRememberMeServices</span><span class="pln"> rememberMeServices</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="typ">SpringSessionRememberMeServices</span><span class="pln"> rememberMeServices </span><span class="pun">=</span><span class="pln">
			</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpringSessionRememberMeServices</span><span class="pun">();</span><span class="pln">
	</span><span class="com">// optionally customize</span><span class="pln">
	rememberMeServices</span><span class="pun">.</span><span class="pln">setAlwaysRemember</span><span class="pun">(</span><span class="kwd">true</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> rememberMeServices</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>An XML-based configuration would look something like the following:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-xml" data-lang="xml"><span class="tag">&lt;security:http&gt;</span><span class="pln">
	</span><span class="com">&lt;!-- ... --&gt;</span><span class="pln">
	</span><span class="tag">&lt;security:form-login</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
	</span><span class="tag">&lt;security:remember-me</span><span class="pln"> </span><span class="atn">services-ref</span><span class="pun">=</span><span class="atv">"rememberMeServices"</span><span class="tag">/&gt;</span><span class="pln">
</span><span class="tag">&lt;/security:http&gt;</span><span class="pln">

</span><span class="tag">&lt;bean</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">"rememberMeServices"</span><span class="pln">
	</span><span class="atn">class</span><span class="pun">=</span><span class="atv">"org.springframework.session.security.web.authentication.SpringSessionRememberMeServices"</span><span class="pln">
	</span><span class="atn">p:alwaysRemember</span><span class="pun">=</span><span class="atv">"true"</span><span class="tag">/&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="spring-security-concurrent-sessions"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#spring-security-concurrent-sessions"></a>8.2. Spring Security Concurrent Session Control</h3>
<div class="paragraph">
<p>Spring Session provides integration with Spring Security to support its concurrent session control.
This allows limiting the number of active sessions that a single user can have concurrently, but, unlike the default
Spring Security support, this also works in a clustered environment. This is done by providing a custom
implementation of Spring Security’s <code>SessionRegistry</code> interface.</p>
</div>
<div class="paragraph">
<p>When using Spring Security’s Java config DSL, you can configure the custom <code>SessionRegistry</code> through the
<code>SessionManagementConfigurer</code>, as the following listing shows:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="lit">@Configuration</span><span class="pln">
</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">SecurityConfiguration</span><span class="pun">&lt;</span><span class="pln">S </span><span class="kwd">extends</span><span class="pln"> </span><span class="typ">Session</span><span class="pun">&gt;</span><span class="pln">
		</span><span class="kwd">extends</span><span class="pln"> </span><span class="typ">WebSecurityConfigurerAdapter</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

	</span><span class="lit">@Autowired</span><span class="pln">
	</span><span class="kwd">private</span><span class="pln"> </span><span class="typ">FindByIndexNameSessionRepository</span><span class="pun">&lt;</span><span class="pln">S</span><span class="pun">&gt;</span><span class="pln"> sessionRepository</span><span class="pun">;</span><span class="pln">

	</span><span class="lit">@Override</span><span class="pln">
	</span><span class="kwd">protected</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> configure</span><span class="pun">(</span><span class="typ">HttpSecurity</span><span class="pln"> http</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">throws</span><span class="pln"> </span><span class="typ">Exception</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="com">// @formatter:off</span><span class="pln">
		http
			</span><span class="com">// other config goes here...</span><span class="pln">
			</span><span class="pun">.</span><span class="pln">sessionManagement</span><span class="pun">()</span><span class="pln">
				</span><span class="pun">.</span><span class="pln">maximumSessions</span><span class="pun">(</span><span class="lit">2</span><span class="pun">)</span><span class="pln">
				</span><span class="pun">.</span><span class="pln">sessionRegistry</span><span class="pun">(</span><span class="pln">sessionRegistry</span><span class="pun">());</span><span class="pln">
		</span><span class="com">// @formatter:on</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">

	</span><span class="lit">@Bean</span><span class="pln">
	</span><span class="kwd">public</span><span class="pln"> </span><span class="typ">SpringSessionBackedSessionRegistry</span><span class="pun">&lt;</span><span class="pln">S</span><span class="pun">&gt;</span><span class="pln"> sessionRegistry</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpringSessionBackedSessionRegistry</span><span class="pun">&lt;&gt;(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">sessionRepository</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This assumes that you have also configured Spring Session to provide a <code>FindByIndexNameSessionRepository</code> that
returns <code>Session</code> instances.</p>
</div>
<div class="paragraph">
<p>When using XML configuration, it would look something like the following listing:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-xml" data-lang="xml"><span class="tag">&lt;security:http&gt;</span><span class="pln">
	</span><span class="com">&lt;!-- other config goes here... --&gt;</span><span class="pln">
	</span><span class="tag">&lt;security:session-management&gt;</span><span class="pln">
		</span><span class="tag">&lt;security:concurrency-control</span><span class="pln"> </span><span class="atn">max-sessions</span><span class="pun">=</span><span class="atv">"2"</span><span class="pln"> </span><span class="atn">session-registry-ref</span><span class="pun">=</span><span class="atv">"sessionRegistry"</span><span class="tag">/&gt;</span><span class="pln">
	</span><span class="tag">&lt;/security:session-management&gt;</span><span class="pln">
</span><span class="tag">&lt;/security:http&gt;</span><span class="pln">

</span><span class="tag">&lt;bean</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">"sessionRegistry"</span><span class="pln">
	  </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"org.springframework.session.security.SpringSessionBackedSessionRegistry"</span><span class="tag">&gt;</span><span class="pln">
	</span><span class="tag">&lt;constructor-arg</span><span class="pln"> </span><span class="atn">ref</span><span class="pun">=</span><span class="atv">"sessionRepository"</span><span class="tag">/&gt;</span><span class="pln">
</span><span class="tag">&lt;/bean&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This assumes that your Spring Session <code>SessionRegistry</code> bean is called <code>sessionRegistry</code>, which is the name used by all
<code>SpringHttpSessionConfiguration</code> subclasses.</p>
</div>
</div>
<div class="sect2">
<h3 id="spring-security-concurrent-sessions-limitations"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#spring-security-concurrent-sessions-limitations"></a>8.3. Limitations</h3>
<div class="paragraph">
<p>Spring Session’s implementation of Spring Security’s <code>SessionRegistry</code> interface does not support the <code>getAllPrincipals</code>
method, as this information cannot be retrieved by using Spring Session. This method is never called by Spring Security,
so this affects only applications that access the <code>SessionRegistry</code> themselves.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="api"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api"></a>9. API Documentation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can browse the complete <a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/api/">Javadoc</a> online. The key APIs are described in the following sections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-session">Using <code>Session</code></a></p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-sessionrepository">Using <code>SessionRepository</code></a></p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-findbyindexnamesessionrepository">Using <code>FindByIndexNameSessionRepository</code></a></p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-reactivesessionrepository">Using <code>ReactiveSessionRepository</code></a></p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-enablespringhttpsession">Using <code>@EnableSpringHttpSession</code></a></p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-enablespringwebsession">Using <code>@EnableSpringWebSession</code></a></p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-redisoperationssessionrepository">Using <code>RedisOperationsSessionRepository</code></a></p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-reactiveredisoperationssessionrepository">Using <code>ReactiveRedisOperationsSessionRepository</code></a></p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-mapsessionrepository">Using <code>MapSessionRepository</code></a></p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-reactivemapsessionrepository">Using <code>ReactiveMapSessionRepository</code></a></p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-jdbcoperationssessionrepository">Using <code>JdbcOperationsSessionRepository</code></a></p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-hazelcastsessionrepository">Using <code>HazelcastSessionRepository</code></a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="api-session"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-session"></a>9.1. Using <code>Session</code></h3>
<div class="paragraph">
<p>A <code>Session</code> is a simplified <code>Map</code> of name value pairs.</p>
</div>
<div class="paragraph">
<p>Typical usage might look like the following listing:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">RepositoryDemo</span><span class="pun">&lt;</span><span class="pln">S </span><span class="kwd">extends</span><span class="pln"> </span><span class="typ">Session</span><span class="pun">&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">private</span><span class="pln"> </span><span class="typ">SessionRepository</span><span class="pun">&lt;</span><span class="pln">S</span><span class="pun">&gt;</span><span class="pln"> repository</span><span class="pun">;</span><span class="pln"> </span><i class="conum" data-value="1"></i><b><span class="pun">(</span><span class="lit">1</span><span class="pun">)</span></b><span class="pln">

	</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> demo</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		S toSave </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">repository</span><span class="pun">.</span><span class="pln">createSession</span><span class="pun">();</span><span class="pln"> </span><i class="conum" data-value="2"></i><b><span class="pun">(</span><span class="lit">2</span><span class="pun">)</span></b><span class="pln">

		</span><i class="conum" data-value="3"></i><b><span class="pun">(</span><span class="lit">3</span><span class="pun">)</span></b><span class="pln">
		</span><span class="typ">User</span><span class="pln"> rwinch </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">User</span><span class="pun">(</span><span class="str">"rwinch"</span><span class="pun">);</span><span class="pln">
		toSave</span><span class="pun">.</span><span class="pln">setAttribute</span><span class="pun">(</span><span class="pln">ATTR_USER</span><span class="pun">,</span><span class="pln"> rwinch</span><span class="pun">);</span><span class="pln">

		</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">repository</span><span class="pun">.</span><span class="pln">save</span><span class="pun">(</span><span class="pln">toSave</span><span class="pun">);</span><span class="pln"> </span><i class="conum" data-value="4"></i><b><span class="pun">(</span><span class="lit">4</span><span class="pun">)</span></b><span class="pln">

		S session </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">repository</span><span class="pun">.</span><span class="pln">findById</span><span class="pun">(</span><span class="pln">toSave</span><span class="pun">.</span><span class="pln">getId</span><span class="pun">());</span><span class="pln"> </span><i class="conum" data-value="5"></i><b><span class="pun">(</span><span class="lit">5</span><span class="pun">)</span></b><span class="pln">

		</span><i class="conum" data-value="6"></i><b><span class="pun">(</span><span class="lit">6</span><span class="pun">)</span></b><span class="pln">
		</span><span class="typ">User</span><span class="pln"> user </span><span class="pun">=</span><span class="pln"> session</span><span class="pun">.</span><span class="pln">getAttribute</span><span class="pun">(</span><span class="pln">ATTR_USER</span><span class="pun">);</span><span class="pln">
		assertThat</span><span class="pun">(</span><span class="pln">user</span><span class="pun">).</span><span class="pln">isEqualTo</span><span class="pun">(</span><span class="pln">rwinch</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">

	</span><span class="com">// ... setter methods ...</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We create a <code>SessionRepository</code> instance with a generic type, <code>S</code>, that extends <code>Session</code>. The generic type is defined in our class.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We create a new <code>Session</code> by using our <code>SessionRepository</code> and assign it to a variable of type <code>S</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We interact with the <code>Session</code>. In our example, we demonstrate saving a <code>User</code> to the <code>Session</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>We now save the <code>Session</code>. This is why we needed the generic type <code>S</code>. The <code>SessionRepository</code> only allows saving <code>Session</code> instances that were created or retrieved by using the same <code>SessionRepository</code>. This allows for the <code>SessionRepository</code> to make implementation specific optimizations (that is, writing only attributes that have changed).</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>We retrieve the <code>Session</code> from the <code>SessionRepository</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>We obtain the persisted <code>User</code> from our <code>Session</code> without the need for explicitly casting our attribute.</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>Session</code> API also provides attributes related to the <code>Session</code> instance’s expiration.</p>
</div>
<div class="paragraph">
<p>Typical usage might look like the following listing:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">ExpiringRepositoryDemo</span><span class="pun">&lt;</span><span class="pln">S </span><span class="kwd">extends</span><span class="pln"> </span><span class="typ">Session</span><span class="pun">&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">private</span><span class="pln"> </span><span class="typ">SessionRepository</span><span class="pun">&lt;</span><span class="pln">S</span><span class="pun">&gt;</span><span class="pln"> repository</span><span class="pun">;</span><span class="pln"> </span><i class="conum" data-value="1"></i><b><span class="pun">(</span><span class="lit">1</span><span class="pun">)</span></b><span class="pln">

	</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> demo</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		S toSave </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">repository</span><span class="pun">.</span><span class="pln">createSession</span><span class="pun">();</span><span class="pln"> </span><i class="conum" data-value="2"></i><b><span class="pun">(</span><span class="lit">2</span><span class="pun">)</span></b><span class="pln">
		</span><span class="com">// ...</span><span class="pln">
		toSave</span><span class="pun">.</span><span class="pln">setMaxInactiveInterval</span><span class="pun">(</span><span class="typ">Duration</span><span class="pun">.</span><span class="pln">ofSeconds</span><span class="pun">(</span><span class="lit">30</span><span class="pun">));</span><span class="pln"> </span><i class="conum" data-value="3"></i><b><span class="pun">(</span><span class="lit">3</span><span class="pun">)</span></b><span class="pln">

		</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">repository</span><span class="pun">.</span><span class="pln">save</span><span class="pun">(</span><span class="pln">toSave</span><span class="pun">);</span><span class="pln"> </span><i class="conum" data-value="4"></i><b><span class="pun">(</span><span class="lit">4</span><span class="pun">)</span></b><span class="pln">

		S session </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">repository</span><span class="pun">.</span><span class="pln">findById</span><span class="pun">(</span><span class="pln">toSave</span><span class="pun">.</span><span class="pln">getId</span><span class="pun">());</span><span class="pln"> </span><i class="conum" data-value="5"></i><b><span class="pun">(</span><span class="lit">5</span><span class="pun">)</span></b><span class="pln">
		</span><span class="com">// ...</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">

	</span><span class="com">// ... setter methods ...</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We create a <code>SessionRepository</code> instance with a generic type, <code>S</code>, that extends <code>Session</code>. The generic type is defined in our class.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We create a new <code>Session</code> by using our <code>SessionRepository</code> and assign it to a variable of type <code>S</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We interact with the <code>Session</code>.
In our example, we demonstrate updating the amount of time the <code>Session</code> can be inactive before it expires.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>We now save the <code>Session</code>.
This is why we needed the generic type, <code>S</code>.
The <code>SessionRepository</code> allows saving only <code>Session</code> instances that were created or retrieved using the same <code>SessionRepository</code>.
This allows for the <code>SessionRepository</code> to make implementation specific optimizations (that is, writing only attributes that have changed).
The last accessed time is automatically updated when the <code>Session</code> is saved.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>We retrieve the <code>Session</code> from the <code>SessionRepository</code>.
If the <code>Session</code> were expired, the result would be null.</td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="api-sessionrepository"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-sessionrepository"></a>9.2. Using <code>SessionRepository</code></h3>
<div class="paragraph">
<p>A <code>SessionRepository</code> is in charge of creating, retrieving, and persisting <code>Session</code> instances.</p>
</div>
<div class="paragraph">
<p>If possible, you should not interact directly with a <code>SessionRepository</code> or a <code>Session</code>.
Instead, developers should prefer interacting with <code>SessionRepository</code> and <code>Session</code> indirectly through the <a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#httpsession"><code>HttpSession</code></a> and <a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#websocket">WebSocket</a> integration.</p>
</div>
</div>
<div class="sect2">
<h3 id="api-findbyindexnamesessionrepository"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-findbyindexnamesessionrepository"></a>9.3. Using <code>FindByIndexNameSessionRepository</code></h3>
<div class="paragraph">
<p>Spring Session’s most basic API for using a <code>Session</code> is the <code>SessionRepository</code>.
This API is intentionally very simple, so that you can easily provide additional implementations with basic functionality.</p>
</div>
<div class="paragraph">
<p>Some <code>SessionRepository</code> implementations may also choose to implement <code>FindByIndexNameSessionRepository</code>.
For example, Spring’s Redis, JDBC, and Hazelcast support libraries all implement <code>FindByIndexNameSessionRepository</code>.</p>
</div>
<div class="paragraph">
<p>The <code>FindByIndexNameSessionRepository</code> provides a method to look up all the sessions with a given index name and index value.
As a common use case that is supported by all provided <code>FindByIndexNameSessionRepository</code> implementations, you can use a convenient method to look up all the sessions for a particular user.
This is done by ensuring that the session attribute with the name of <code>FindByIndexNameSessionRepository.PRINCIPAL_NAME_INDEX_NAME</code> is populated with the username.
It is your responsibility to ensure that the attribute is populated, since Spring Session is not aware of the authentication mechanism being used.
An example of how to use this can be seen in the following listing:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="typ">String</span><span class="pln"> username </span><span class="pun">=</span><span class="pln"> </span><span class="str">"username"</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">session</span><span class="pun">.</span><span class="pln">setAttribute</span><span class="pun">(</span><span class="pln">
		</span><span class="typ">FindByIndexNameSessionRepository</span><span class="pun">.</span><span class="pln">PRINCIPAL_NAME_INDEX_NAME</span><span class="pun">,</span><span class="pln"> username</span><span class="pun">);</span></code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Some implementations of <code>FindByIndexNameSessionRepository</code> provide hooks to automatically index other session attributes.
For example, many implementations automatically ensure that the current Spring Security user name is indexed with the index name of <code>FindByIndexNameSessionRepository.PRINCIPAL_NAME_INDEX_NAME</code>.
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Once the session is indexed, you can find by using code similar to the following:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="typ">String</span><span class="pln"> username </span><span class="pun">=</span><span class="pln"> </span><span class="str">"username"</span><span class="pun">;</span><span class="pln">
</span><span class="typ">Map</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Session</span><span class="pun">&gt;</span><span class="pln"> sessionIdToSession </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">sessionRepository
		</span><span class="pun">.</span><span class="pln">findByPrincipalName</span><span class="pun">(</span><span class="pln">username</span><span class="pun">);</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="api-reactivesessionrepository"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-reactivesessionrepository"></a>9.4. Using <code>ReactiveSessionRepository</code></h3>
<div class="paragraph">
<p>A <code>ReactiveSessionRepository</code> is in charge of creating, retrieving, and persisting <code>Session</code> instances in a non-blocking and reactive manner.</p>
</div>
<div class="paragraph">
<p>If possible, you should not interact directly with a <code>ReactiveSessionRepository</code> or a <code>Session</code>.
Instead, you should prefer interacting with <code>ReactiveSessionRepository</code> and <code>Session</code> indirectly through the <a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#websession">WebSession</a> integration.</p>
</div>
</div>
<div class="sect2">
<h3 id="api-enablespringhttpsession"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-enablespringhttpsession"></a>9.5. Using <code>@EnableSpringHttpSession</code></h3>
<div class="paragraph">
<p>You can add the <code>@EnableSpringHttpSession</code> annotation to a <code>@Configuration</code> class to expose the <code>SessionRepositoryFilter</code> as a bean named <code>springSessionRepositoryFilter</code>.
In order to use the annotation, you must provide a single <code>SessionRepository</code> bean.
The following example shows how to do so:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="lit">@EnableSpringHttpSession</span><span class="pln">
</span><span class="lit">@Configuration</span><span class="pln">
</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">SpringHttpSessionConfig</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="lit">@Bean</span><span class="pln">
	</span><span class="kwd">public</span><span class="pln"> </span><span class="typ">MapSessionRepository</span><span class="pln"> sessionRepository</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">MapSessionRepository</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ConcurrentHashMap</span><span class="pun">&lt;&gt;());</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Note that no infrastructure for session expirations is configured for you.
This is because things such as session expiration are highly implementation-dependent.
This means that, if you need to clean up expired sessions, you are responsible for cleaning up the expired sessions.</p>
</div>
</div>
<div class="sect2">
<h3 id="api-enablespringwebsession"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-enablespringwebsession"></a>9.6. Using <code>@EnableSpringWebSession</code></h3>
<div class="paragraph">
<p>You can add the <code>@EnableSpringWebSession</code> annotation to a <code>@Configuration</code> class to expose the <code>WebSessionManager</code> as a bean named <code>webSessionManager</code>.
To use the annotation, you must provide a single <code>ReactiveSessionRepository</code> bean.
The following example shows how to do so:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="lit">@EnableSpringWebSession</span><span class="pln">
</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">SpringWebSessionConfig</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="lit">@Bean</span><span class="pln">
	</span><span class="kwd">public</span><span class="pln"> </span><span class="typ">ReactiveSessionRepository</span><span class="pln"> reactiveSessionRepository</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ReactiveMapSessionRepository</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ConcurrentHashMap</span><span class="pun">&lt;&gt;());</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Note that no infrastructure for session expirations is configured for you.
This is because things such as session expiration are highly implementation-dependent.
This means that, if you require cleaning up expired sessions, you are responsible for cleaning up the expired sessions.</p>
</div>
</div>
<div class="sect2">
<h3 id="api-redisoperationssessionrepository"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-redisoperationssessionrepository"></a>9.7. Using <code>RedisOperationsSessionRepository</code></h3>
<div class="paragraph">
<p><code>RedisOperationsSessionRepository</code> is a <code>SessionRepository</code> that is implemented by using Spring Data’s <code>RedisOperations</code>.
In a web environment, this is typically used in combination with <code>SessionRepositoryFilter</code>.
The implementation supports <code>SessionDestroyedEvent</code> and <code>SessionCreatedEvent</code> through <code>SessionMessageListener</code>.</p>
</div>
<div class="sect3">
<h4 id="api-redisoperationssessionrepository-new"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-redisoperationssessionrepository-new"></a>9.7.1. Instantiating a <code>RedisOperationsSessionRepository</code></h4>
<div class="paragraph">
<p>You can see a typical example of how to create a new instance in the following listing:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="typ">RedisTemplate</span><span class="pun">&lt;</span><span class="typ">Object</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Object</span><span class="pun">&gt;</span><span class="pln"> redisTemplate </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">RedisTemplate</span><span class="pun">&lt;&gt;();</span><span class="pln">

</span><span class="com">// ... configure redisTemplate ...</span><span class="pln">

</span><span class="typ">SessionRepository</span><span class="pun">&lt;?</span><span class="pln"> </span><span class="kwd">extends</span><span class="pln"> </span><span class="typ">Session</span><span class="pun">&gt;</span><span class="pln"> repository </span><span class="pun">=</span><span class="pln">
		</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">RedisOperationsSessionRepository</span><span class="pun">(</span><span class="pln">redisTemplate</span><span class="pun">);</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>For additional information on how to create a <code>RedisConnectionFactory</code>, see the Spring Data Redis Reference.</p>
</div>
</div>
<div class="sect3">
<h4 id="api-redisoperationssessionrepository-config"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-redisoperationssessionrepository-config"></a>9.7.2. Using <code>@EnableRedisHttpSession</code></h4>
<div class="paragraph">
<p>In a web environment, the simplest way to create a new <code>RedisOperationsSessionRepository</code> is to use <code>@EnableRedisHttpSession</code>.
You can find complete example usage in the <a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#samples">Samples and Guides (Start Here)</a>.
You can use the following attributes to customize the configuration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>maxInactiveIntervalInSeconds</strong>: The amount of time before the session expires, in seconds.</p>
</li>
<li>
<p><strong>redisNamespace</strong>: Allows configuring an application specific namespace for the sessions. Redis keys and channel IDs start with the prefix of <code>&lt;redisNamespace&gt;:</code>.</p>
</li>
<li>
<p><strong>redisFlushMode</strong>: Allows specifying when data is written to Redis. The default is only when <code>save</code> is invoked on <code>SessionRepository</code>.
A value of <code>RedisFlushMode.IMMEDIATE</code> writes to Redis as soon as possible.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="custom-code-redisserializer-code"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#custom-code-redisserializer-code"></a>Custom <code>RedisSerializer</code></h5>
<div class="paragraph">
<p>You can customize the serialization by creating a bean named <code>springSessionDefaultRedisSerializer</code> that implements <code>RedisSerializer&lt;Object&gt;</code>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="redis-code-taskexecutor-code"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#redis-code-taskexecutor-code"></a>9.7.3. Redis <code>TaskExecutor</code></h4>
<div class="paragraph">
<p><code>RedisOperationsSessionRepository</code> is subscribed to receive events from Redis by using a <code>RedisMessageListenerContainer</code>.
You can customize the way those events are dispatched by creating a bean named <code>springSessionRedisTaskExecutor</code>, a bean <code>springSessionRedisSubscriptionExecutor</code>, or both.
You can find more details on configuring Redis task executors <a href="https://docs.spring.io/spring-data-redis/docs/2.1.8.RELEASE/reference/html/#redis:pubsub:subscribe:containers">here</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="api-redisoperationssessionrepository-storage"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-redisoperationssessionrepository-storage"></a>9.7.4. Storage Details</h4>
<div class="paragraph">
<p>The following sections outline how Redis is updated for each operation.
The following example shows an example of creating a new session:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre>HMSET spring:session:sessions:33fdd1b6-b496-4b33-9f7d-df96679d32fe creationTime 1404360000000 \
	maxInactiveInterval 1800 \
	lastAccessedTime 1404360000000 \
	sessionAttr:attrName someAttrValue \
	sessionAttr2:attrName someAttrValue2
EXPIRE spring:session:sessions:33fdd1b6-b496-4b33-9f7d-df96679d32fe 2100
APPEND spring:session:sessions:expires:33fdd1b6-b496-4b33-9f7d-df96679d32fe ""
EXPIRE spring:session:sessions:expires:33fdd1b6-b496-4b33-9f7d-df96679d32fe 1800
SADD spring:session:expirations:1439245080000 expires:33fdd1b6-b496-4b33-9f7d-df96679d32fe
EXPIRE spring:session:expirations1439245080000 2100</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The subsequent sections describe the details.</p>
</div>
<div class="sect4">
<h5 id="saving-a-session"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#saving-a-session"></a>Saving a Session</h5>
<div class="paragraph">
<p>Each session is stored in Redis as a <code>Hash</code>.
Each session is set and updated by using the <code>HMSET</code> command.
The following example shows how each session is stored:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre>HMSET spring:session:sessions:33fdd1b6-b496-4b33-9f7d-df96679d32fe creationTime 1404360000000 \
	maxInactiveInterval 1800 \
	lastAccessedTime 1404360000000 \
	sessionAttr:attrName someAttrValue \
	sessionAttr2:attrName someAttrValue2</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In the preceding example, the following statements are true about the session:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The session ID is 33fdd1b6-b496-4b33-9f7d-df96679d32fe.</p>
</li>
<li>
<p>The session was created at 1404360000000 (in milliseconds since midnight of 1/1/1970 GMT).</p>
</li>
<li>
<p>The session expires in 1800 seconds (30 minutes).</p>
</li>
<li>
<p>The session was last accessed at 1404360000000 (in milliseconds since midnight of 1/1/1970 GMT).</p>
</li>
<li>
<p>The session has two attributes.
The first is <code>attrName</code>, with a value of <code>someAttrValue</code>.
The second session attribute is named <code>attrName2</code>, with a value of <code>someAttrValue2</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="api-redisoperationssessionrepository-writes"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-redisoperationssessionrepository-writes"></a>Optimized Writes</h5>
<div class="paragraph">
<p>The <code>Session</code> instances managed by <code>RedisOperationsSessionRepository</code> keeps track of the properties that have changed and updates only those.
This means that, if an attribute is written once and read many times, we need to write that attribute only once.
For example, assume the <code>sessionAttr2</code> session attribute from the lsiting in the preceding section was updated.
The following command would be run upon saving:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre>HMSET spring:session:sessions:33fdd1b6-b496-4b33-9f7d-df96679d32fe sessionAttr:attrName2 newValue</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-redisoperationssessionrepository-expiration"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-redisoperationssessionrepository-expiration"></a>Session Expiration</h5>
<div class="paragraph">
<p>An expiration is associated with each session by using the <code>EXPIRE</code> command, based upon the <code>Session.getMaxInactiveInterval()</code>.
The following example shows a typical <code>EXPIRE</code> command:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre>EXPIRE spring:session:sessions:33fdd1b6-b496-4b33-9f7d-df96679d32fe 2100</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Note that the expiration that is set to five minutes after the session actually expires.
This is necessary so that the value of the session can be accessed when the session expires.
An expiration is set on the session itself five minutes after it actually expires to ensure that it is cleaned up, but only after we perform any necessary processing.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>SessionRepository.findById(String)</code> method ensures that no expired sessions are returned.
This means that you need not check the expiration before using a session.
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Spring Session relies on the delete and expired <a href="https://redis.io/topics/notifications">keyspace notifications</a> from Redis to fire a <a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-redisoperationssessionrepository-sessiondestroyedevent"><code>SessionDeletedEvent</code></a> and a <a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-redisoperationssessionrepository-sessiondestroyedevent"><code>SessionExpiredEvent</code></a>, respectively.
<code>SessionDeletedEvent</code> or <code>SessionExpiredEvent</code> ensure that resources associated with the <code>Session</code> are cleaned up.
For example, when you use Spring Session’s WebSocket support, the Redis expired or delete event triggers any WebSocket connections associated with the session to be closed.</p>
</div>
<div class="paragraph">
<p>Expiration is not tracked directly on the session key itself, since this would mean the session data would no longer be available. Instead, a special session expires key is used. In the preceding example, the expires key is as follows:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre>APPEND spring:session:sessions:expires:33fdd1b6-b496-4b33-9f7d-df96679d32fe ""
EXPIRE spring:session:sessions:expires:33fdd1b6-b496-4b33-9f7d-df96679d32fe 1800</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>When a session expires key is deleted or expires, the keyspace notification triggers a lookup of the actual session, and a <code>SessionDestroyedEvent</code> is fired.</p>
</div>
<div class="paragraph">
<p>One problem with relying on Redis expiration exclusively is that, if the key has not been accessed, Redis makes no guarantee of when the expired event is fired.
Specifically, the background task that Redis uses to clean up expired keys is a low-priority task and may not trigger the key expiration.
For additional details, see the <a href="https://redis.io/topics/notifications">Timing of Expired Events</a> section in the Redis documentation.</p>
</div>
<div class="paragraph">
<p>To circumvent the fact that expired events are not guaranteed to happen, we can ensure that each key is accessed when it is expected to expire.
This means that, if the TTL is expired on the key, Redis removes the key and fires the expired event when we try to access the key.</p>
</div>
<div class="paragraph">
<p>For this reason, each session expiration is also tracked to the nearest minute.
This lets a background task access the potentially expired sessions to ensure that Redis expired events are fired in a more deterministic fashion.
The following example shows these events:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre>SADD spring:session:expirations:1439245080000 expires:33fdd1b6-b496-4b33-9f7d-df96679d32fe
EXPIRE spring:session:expirations1439245080000 2100</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The background task then uses these mappings to explicitly request each key.
By accessing the key, rather than deleting it, we ensure that Redis deletes the key for us only if the TTL is expired.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
We do not explicitly delete the keys, since, in some instances, there may be a race condition that incorrectly identifies a key as expired when it is not.
Short of using distributed locks (which would kill our performance), there is no way to ensure the consistency of the expiration mapping.
By simply accessing the key, we ensure that the key is only removed if the TTL on that key is expired.
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-redisoperationssessionrepository-sessiondestroyedevent"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-redisoperationssessionrepository-sessiondestroyedevent"></a>9.7.5. <code>SessionDeletedEvent</code> and <code>SessionExpiredEvent</code></h4>
<div class="paragraph">
<p><code>SessionDeletedEvent</code> and <code>SessionExpiredEvent</code> are both types of <code>SessionDestroyedEvent</code>.</p>
</div>
<div class="paragraph">
<p><code>RedisOperationsSessionRepository</code> supports firing a <code>SessionDeletedEvent</code> when a <code>Session</code> is deleted or a <code>SessionExpiredEvent</code> when a <code>Session</code> expires.
This is necessary to ensure resources associated with the <code>Session</code> are properly cleaned up.</p>
</div>
<div class="paragraph">
<p>For example, when integrating with WebSockets, the <code>SessionDestroyedEvent</code> is in charge of closing any active WebSocket connections.</p>
</div>
<div class="paragraph">
<p>Firing <code>SessionDeletedEvent</code> or <code>SessionExpiredEvent</code> is made available through the <code>SessionMessageListener</code>, which listens to <a href="https://redis.io/topics/notifications">Redis Keyspace events</a>.
In order for this to work, Redis Keyspace events for Generic commands and Expired events needs to be enabled.
The following example shows how to do so:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-bash" data-lang="bash"><span class="pln">redis</span><span class="pun">-</span><span class="pln">cli config </span><span class="kwd">set</span><span class="pln"> notify</span><span class="pun">-</span><span class="pln">keyspace</span><span class="pun">-</span><span class="pln">events </span><span class="typ">Egx</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If you use <code>@EnableRedisHttpSession</code>, managing the <code>SessionMessageListener</code> and enabling the necessary Redis Keyspace events is done automatically.
However, in a secured Redis enviornment, the config command is disabled.
This means that Spring Session cannot configure Redis Keyspace events for you.
To disable the automatic configuration, add <code>ConfigureRedisAction.NO_OP</code> as a bean.</p>
</div>
<div class="paragraph">
<p>For example, with Java configuration, you can use the following:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="lit">@Bean</span><span class="pln">
</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="typ">ConfigureRedisAction</span><span class="pln"> configureRedisAction</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="typ">ConfigureRedisAction</span><span class="pun">.</span><span class="pln">NO_OP</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In XML configuration, you can use the following:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-xml" data-lang="xml"><span class="tag">&lt;util:constant</span><span class="pln">
	</span><span class="atn">static-field</span><span class="pun">=</span><span class="atv">"org.springframework.session.data.redis.config.ConfigureRedisAction.NO_OP"</span><span class="tag">/&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-redisoperationssessionrepository-sessioncreatedevent"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-redisoperationssessionrepository-sessioncreatedevent"></a>9.7.6. Using <code>SessionCreatedEvent</code></h4>
<div class="paragraph">
<p>When a session is created, an event is sent to Redis with a channel ID of <code>spring:session:channel:created:33fdd1b6-b496-4b33-9f7d-df96679d32fe</code>,
where <code>33fdd1b6-b496-4b33-9f7d-df96679d32fe</code> is the session ID. The body of the event is the session that was created.</p>
</div>
<div class="paragraph">
<p>If registered as a <code>MessageListener</code> (the default), <code>RedisOperationsSessionRepository</code> then translates the Redis message into a <code>SessionCreatedEvent</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="api-redisoperationssessionrepository-cli"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-redisoperationssessionrepository-cli"></a>9.7.7. Viewing the Session in Redis</h4>
<div class="paragraph">
<p>After <a href="https://redis.io/topics/quickstart">installing redis-cli</a>, you can inspect the values in Redis <a href="https://redis.io/commands#hash">using the redis-cli</a>.
For example, you can enter the following into a terminal:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-bash" data-lang="bash"><span class="pln">$ redis</span><span class="pun">-</span><span class="pln">cli
redis </span><span class="lit">127.0</span><span class="pun">.</span><span class="lit">0.1</span><span class="pun">:</span><span class="lit">6379</span><span class="pun">&gt;</span><span class="pln"> keys </span><span class="pun">*</span><span class="pln">
</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="str">"spring:session:sessions:4fc39ce3-63b3-4e17-b1c4-5e1ed96fb021"</span><span class="pln"> </span><i class="conum" data-value="1"></i><b><span class="pun">(</span><span class="lit">1</span><span class="pun">)</span></b><span class="pln">
</span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="str">"spring:session:expirations:1418772300000"</span><span class="pln"> </span><i class="conum" data-value="2"></i><b><span class="pun">(</span><span class="lit">2</span><span class="pun">)</span></b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The suffix of this key is the session identifier of the Spring Session.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>This key contains all the session IDs that should be deleted at the time <code>1418772300000</code>.</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="paragraph">
<p>You can also view the attributes of each session.
The following example shows how to do so:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-bash" data-lang="bash"><span class="pln">redis </span><span class="lit">127.0</span><span class="pun">.</span><span class="lit">0.1</span><span class="pun">:</span><span class="lit">6379</span><span class="pun">&gt;</span><span class="pln"> hkeys spring</span><span class="pun">:</span><span class="pln">session</span><span class="pun">:</span><span class="pln">sessions</span><span class="pun">:</span><span class="lit">4fc39ce3</span><span class="pun">-</span><span class="lit">63b3</span><span class="pun">-</span><span class="lit">4e17</span><span class="pun">-</span><span class="pln">b1c4</span><span class="pun">-</span><span class="lit">5e1ed96fb021</span><span class="pln">
</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="str">"lastAccessedTime"</span><span class="pln">
</span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="str">"creationTime"</span><span class="pln">
</span><span class="lit">3</span><span class="pun">)</span><span class="pln"> </span><span class="str">"maxInactiveInterval"</span><span class="pln">
</span><span class="lit">4</span><span class="pun">)</span><span class="pln"> </span><span class="str">"sessionAttr:username"</span><span class="pln">
redis </span><span class="lit">127.0</span><span class="pun">.</span><span class="lit">0.1</span><span class="pun">:</span><span class="lit">6379</span><span class="pun">&gt;</span><span class="pln"> hget spring</span><span class="pun">:</span><span class="pln">session</span><span class="pun">:</span><span class="pln">sessions</span><span class="pun">:</span><span class="lit">4fc39ce3</span><span class="pun">-</span><span class="lit">63b3</span><span class="pun">-</span><span class="lit">4e17</span><span class="pun">-</span><span class="pln">b1c4</span><span class="pun">-</span><span class="lit">5e1ed96fb021</span><span class="pln"> sessionAttr</span><span class="pun">:</span><span class="pln">username
</span><span class="str">"\xac\xed\x00\x05t\x00\x03rob"</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="api-reactiveredisoperationssessionrepository"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-reactiveredisoperationssessionrepository"></a>9.8. Using <code>ReactiveRedisOperationsSessionRepository</code></h3>
<div class="paragraph">
<p><code>ReactiveRedisOperationsSessionRepository</code> is a <code>ReactiveSessionRepository</code> that is implemented by using Spring Data’s <code>ReactiveRedisOperations</code>.
In a web environment, this is typically used in combination with <code>WebSessionStore</code>.</p>
</div>
<div class="sect3">
<h4 id="api-reactiveredisoperationssessionrepository-new"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-reactiveredisoperationssessionrepository-new"></a>9.8.1. Instantiating a <code>ReactiveRedisOperationsSessionRepository</code></h4>
<div class="paragraph">
<p>The following example shows how to create a new instance:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="com">// ... create and configure connectionFactory and serializationContext ...</span><span class="pln">

</span><span class="typ">ReactiveRedisTemplate</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Object</span><span class="pun">&gt;</span><span class="pln"> redisTemplate </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ReactiveRedisTemplate</span><span class="pun">&lt;&gt;(</span><span class="pln">
		connectionFactory</span><span class="pun">,</span><span class="pln"> serializationContext</span><span class="pun">);</span><span class="pln">

</span><span class="typ">ReactiveSessionRepository</span><span class="pun">&lt;?</span><span class="pln"> </span><span class="kwd">extends</span><span class="pln"> </span><span class="typ">Session</span><span class="pun">&gt;</span><span class="pln"> repository </span><span class="pun">=</span><span class="pln">
		</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ReactiveRedisOperationsSessionRepository</span><span class="pun">(</span><span class="pln">redisTemplate</span><span class="pun">);</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>For additional information on how to create a <code>ReactiveRedisConnectionFactory</code>, see the Spring Data Redis Reference.</p>
</div>
</div>
<div class="sect3">
<h4 id="api-reactiveredisoperationssessionrepository-config"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-reactiveredisoperationssessionrepository-config"></a>9.8.2. Using <code>@EnableRedisWebSession</code></h4>
<div class="paragraph">
<p>In a web environment, the simplest way to create a new <code>ReactiveRedisOperationsSessionRepository</code> is to use <code>@EnableRedisWebSession</code>.
You can use the following attributes to customize the configuration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>maxInactiveIntervalInSeconds</strong>: The amount of time before the session expires, in seconds</p>
</li>
<li>
<p><strong>redisNamespace</strong>: Allows configuring an application specific namespace for the sessions. Redis keys and channel IDs start with q prefix of <code>&lt;redisNamespace&gt;:</code>.</p>
</li>
<li>
<p><strong>redisFlushMode</strong>: Allows specifying when data is written to Redis. The default is only when <code>save</code> is invoked on <code>ReactiveSessionRepository</code>.
A value of <code>RedisFlushMode.IMMEDIATE</code> writes to Redis as soon as possible.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-reactiveredisoperationssessionrepository-writes"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-reactiveredisoperationssessionrepository-writes"></a>Optimized Writes</h5>
<div class="paragraph">
<p>The <code>Session</code> instances managed by <code>ReactiveRedisOperationsSessionRepository</code> keep track of the properties that have changed and updates only those.
This means that, if an attribute is written once and read many times, we need to write that attribute only once.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-reactiveredisoperationssessionrepository-cli"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-reactiveredisoperationssessionrepository-cli"></a>9.8.3. Viewing the Session in Redis</h4>
<div class="paragraph">
<p>After <a href="https://redis.io/topics/quickstart">installing redis-cli</a>, you can inspect the values in Redis <a href="https://redis.io/commands#hash">using the redis-cli</a>.
For example, you can enter the following command into a terminal window:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-bash" data-lang="bash"><span class="pln">$ redis</span><span class="pun">-</span><span class="pln">cli
redis </span><span class="lit">127.0</span><span class="pun">.</span><span class="lit">0.1</span><span class="pun">:</span><span class="lit">6379</span><span class="pun">&gt;</span><span class="pln"> keys </span><span class="pun">*</span><span class="pln">
</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="str">"spring:session:sessions:4fc39ce3-63b3-4e17-b1c4-5e1ed96fb021"</span><span class="pln"> </span><i class="conum" data-value="1"></i><b><span class="pun">(</span><span class="lit">1</span><span class="pun">)</span></b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The suffix of this key is the session identifier of the Spring Session.</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="paragraph">
<p>You can also view the attributes of each session by using the <code>hkeys</code> command.
The following example shows how to do so:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-bash" data-lang="bash"><span class="pln">redis </span><span class="lit">127.0</span><span class="pun">.</span><span class="lit">0.1</span><span class="pun">:</span><span class="lit">6379</span><span class="pun">&gt;</span><span class="pln"> hkeys spring</span><span class="pun">:</span><span class="pln">session</span><span class="pun">:</span><span class="pln">sessions</span><span class="pun">:</span><span class="lit">4fc39ce3</span><span class="pun">-</span><span class="lit">63b3</span><span class="pun">-</span><span class="lit">4e17</span><span class="pun">-</span><span class="pln">b1c4</span><span class="pun">-</span><span class="lit">5e1ed96fb021</span><span class="pln">
</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="str">"lastAccessedTime"</span><span class="pln">
</span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="str">"creationTime"</span><span class="pln">
</span><span class="lit">3</span><span class="pun">)</span><span class="pln"> </span><span class="str">"maxInactiveInterval"</span><span class="pln">
</span><span class="lit">4</span><span class="pun">)</span><span class="pln"> </span><span class="str">"sessionAttr:username"</span><span class="pln">
redis </span><span class="lit">127.0</span><span class="pun">.</span><span class="lit">0.1</span><span class="pun">:</span><span class="lit">6379</span><span class="pun">&gt;</span><span class="pln"> hget spring</span><span class="pun">:</span><span class="pln">session</span><span class="pun">:</span><span class="pln">sessions</span><span class="pun">:</span><span class="lit">4fc39ce3</span><span class="pun">-</span><span class="lit">63b3</span><span class="pun">-</span><span class="lit">4e17</span><span class="pun">-</span><span class="pln">b1c4</span><span class="pun">-</span><span class="lit">5e1ed96fb021</span><span class="pln"> sessionAttr</span><span class="pun">:</span><span class="pln">username
</span><span class="str">"\xac\xed\x00\x05t\x00\x03rob"</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="api-mapsessionrepository"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-mapsessionrepository"></a>9.9. Using <code>MapSessionRepository</code></h3>
<div class="paragraph">
<p>The <code>MapSessionRepository</code> allows for persisting <code>Session</code> in a <code>Map</code>, with the key being the <code>Session</code> ID and the value being the <code>Session</code>.
You can use the implementation with a <code>ConcurrentHashMap</code> as a testing or convenience mechanism.
Alternatively, you can use it with distributed <code>Map</code> implementations. For example, it can be used with Hazelcast.</p>
</div>
<div class="sect3">
<h4 id="api-mapsessionrepository-new"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-mapsessionrepository-new"></a>9.9.1. Instantiating <code>MapSessionRepository</code></h4>
<div class="paragraph">
<p>The following example shows how to create a new instance:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="typ">SessionRepository</span><span class="pun">&lt;?</span><span class="pln"> </span><span class="kwd">extends</span><span class="pln"> </span><span class="typ">Session</span><span class="pun">&gt;</span><span class="pln"> repository </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">MapSessionRepository</span><span class="pun">(</span><span class="pln">
		</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ConcurrentHashMap</span><span class="pun">&lt;&gt;());</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-mapsessionrepository-hazelcast"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-mapsessionrepository-hazelcast"></a>9.9.2. Using Spring Session and Hazlecast</h4>
<div class="paragraph">
<p>The <a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#samples">Hazelcast Sample</a> is a complete application that demonstrates how to use Spring Session with Hazelcast.</p>
</div>
<div class="paragraph">
<p>To run it, use the following command:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre>	./gradlew :samples:hazelcast:tomcatRun</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#samples">Hazelcast Spring Sample</a> is a complete application that demonstrates how to use Spring Session with Hazelcast and Spring Security.</p>
</div>
<div class="paragraph">
<p>It includes example Hazelcast <code>MapListener</code> implementations that support firing <code>SessionCreatedEvent</code>, <code>SessionDeletedEvent</code>, and <code>SessionExpiredEvent</code>.</p>
</div>
<div class="paragraph">
<p>To run it, use the following command:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre>	./gradlew :samples:hazelcast-spring:tomcatRun</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="api-reactivemapsessionrepository"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-reactivemapsessionrepository"></a>9.10. Using <code>ReactiveMapSessionRepository</code></h3>
<div class="paragraph">
<p>The <code>ReactiveMapSessionRepository</code> allows for persisting <code>Session</code> in a <code>Map</code>, with the key being the <code>Session</code> ID and the value being the <code>Session</code>.
You can use the implementation with a <code>ConcurrentHashMap</code> as a testing or convenience mechanism.
Alternatively, you can use it with distributed <code>Map</code> implementations, with the requirement that the supplied <code>Map</code> must be non-blocking.</p>
</div>
</div>
<div class="sect2">
<h3 id="api-jdbcoperationssessionrepository"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-jdbcoperationssessionrepository"></a>9.11. Using <code>JdbcOperationsSessionRepository</code></h3>
<div class="paragraph">
<p><code>JdbcOperationsSessionRepository</code> is a <code>SessionRepository</code> implementation that uses Spring’s <code>JdbcOperations</code> to store sessions in a relational database.
In a web environment, this is typically used in combination with <code>SessionRepositoryFilter</code>.
Note that this implementation does not support publishing of session events.</p>
</div>
<div class="sect3">
<h4 id="api-jdbcoperationssessionrepository-new"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-jdbcoperationssessionrepository-new"></a>9.11.1. Instantiating a <code>JdbcOperationsSessionRepository</code></h4>
<div class="paragraph">
<p>The following example shows how to create a new instance:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="typ">JdbcTemplate</span><span class="pln"> jdbcTemplate </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">JdbcTemplate</span><span class="pun">();</span><span class="pln">

</span><span class="com">// ... configure JdbcTemplate ...</span><span class="pln">

</span><span class="typ">PlatformTransactionManager</span><span class="pln"> transactionManager </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">DataSourceTransactionManager</span><span class="pun">();</span><span class="pln">

</span><span class="com">// ... configure transactionManager ...</span><span class="pln">

</span><span class="typ">SessionRepository</span><span class="pun">&lt;?</span><span class="pln"> </span><span class="kwd">extends</span><span class="pln"> </span><span class="typ">Session</span><span class="pun">&gt;</span><span class="pln"> repository </span><span class="pun">=</span><span class="pln">
		</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">JdbcOperationsSessionRepository</span><span class="pun">(</span><span class="pln">jdbcTemplate</span><span class="pun">,</span><span class="pln"> transactionManager</span><span class="pun">);</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>For additional information on how to create and configure <code>JdbcTemplate</code> and <code>PlatformTransactionManager</code>, see the <a href="https://docs.spring.io/spring/docs/5.1.7.RELEASE/spring-framework-reference/data-access.html">Spring Framework Reference Documentation</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="api-jdbcoperationssessionrepository-config"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-jdbcoperationssessionrepository-config"></a>9.11.2. Using <code>@EnableJdbcHttpSession</code></h4>
<div class="paragraph">
<p>In a web environment, the simplest way to create a new <code>JdbcOperationsSessionRepository</code> is to use <code>@EnableJdbcHttpSession</code>.
You can find complete example usage in the <a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#samples">Samples and Guides (Start Here)</a>
You can use the following attributes to customize the configuration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>tableName</strong>: The name of database table used by Spring Session to store sessions</p>
</li>
<li>
<p><strong>maxInactiveIntervalInSeconds</strong>: The amount of time before the session will expire in seconds</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="customizing-code-lobhandler-code"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#customizing-code-lobhandler-code"></a>Customizing <code>LobHandler</code></h5>
<div class="paragraph">
<p>You can customize BLOB handling by creating a bean named <code>springSessionLobHandler</code> that implements <code>LobHandler</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="customizing-code-conversionservice-code"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#customizing-code-conversionservice-code"></a>Customizing <code>ConversionService</code></h5>
<div class="paragraph">
<p>You can customize the default serialization and deserialization of the session by providing a <code>ConversionService</code> instance.
When working in a typical Spring environment, the default <code>ConversionService</code> bean (named <code>conversionService</code>) is automatically picked up and used for serialization and deserialization.
However, you can override the default <code>ConversionService</code> by providing a bean named <code>springSessionConversionService</code>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-jdbcoperationssessionrepository-storage"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-jdbcoperationssessionrepository-storage"></a>9.11.3. Storage Details</h4>
<div class="paragraph">
<p>By default, this implementation uses <code>SPRING_SESSION</code> and <code>SPRING_SESSION_ATTRIBUTES</code> tables to store sessions.
Note that you can customize the table name, as already described. In that case, the table used to store attributes is named by using the provided table name suffixed with <code>_ATTRIBUTES</code>.
If further customizations are needed, you can customize the SQL queries used by the repository by using <code>set*Query</code> setter methods. In this case, you need to manually configure the <code>sessionRepository</code> bean.</p>
</div>
<div class="paragraph">
<p>Due to the differences between the various database vendors, especially when it comes to storing binary data, make sure to use SQL scripts specific to your database.
Scripts for most major database vendors are packaged as <code>org/springframework/session/jdbc/schema-*.sql</code>, where <code>*</code> is the target database type.</p>
</div>
<div class="paragraph">
<p>For example, with PostgreSQL, you can use the following schema script:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-sql" data-lang="sql"><span class="pln">CREATE TABLE SPRING_SESSION </span><span class="pun">(</span><span class="pln">
	PRIMARY_ID CHAR</span><span class="pun">(</span><span class="lit">36</span><span class="pun">)</span><span class="pln"> NOT NULL</span><span class="pun">,</span><span class="pln">
	SESSION_ID CHAR</span><span class="pun">(</span><span class="lit">36</span><span class="pun">)</span><span class="pln"> NOT NULL</span><span class="pun">,</span><span class="pln">
	CREATION_TIME BIGINT NOT NULL</span><span class="pun">,</span><span class="pln">
	LAST_ACCESS_TIME BIGINT NOT NULL</span><span class="pun">,</span><span class="pln">
	MAX_INACTIVE_INTERVAL INT NOT NULL</span><span class="pun">,</span><span class="pln">
	EXPIRY_TIME BIGINT NOT NULL</span><span class="pun">,</span><span class="pln">
	PRINCIPAL_NAME VARCHAR</span><span class="pun">(</span><span class="lit">100</span><span class="pun">),</span><span class="pln">
	CONSTRAINT SPRING_SESSION_PK PRIMARY KEY </span><span class="pun">(</span><span class="pln">PRIMARY_ID</span><span class="pun">)</span><span class="pln">
</span><span class="pun">);</span><span class="pln">

CREATE UNIQUE INDEX SPRING_SESSION_IX1 ON SPRING_SESSION </span><span class="pun">(</span><span class="pln">SESSION_ID</span><span class="pun">);</span><span class="pln">
CREATE INDEX SPRING_SESSION_IX2 ON SPRING_SESSION </span><span class="pun">(</span><span class="pln">EXPIRY_TIME</span><span class="pun">);</span><span class="pln">
CREATE INDEX SPRING_SESSION_IX3 ON SPRING_SESSION </span><span class="pun">(</span><span class="pln">PRINCIPAL_NAME</span><span class="pun">);</span><span class="pln">

CREATE TABLE SPRING_SESSION_ATTRIBUTES </span><span class="pun">(</span><span class="pln">
	SESSION_PRIMARY_ID CHAR</span><span class="pun">(</span><span class="lit">36</span><span class="pun">)</span><span class="pln"> NOT NULL</span><span class="pun">,</span><span class="pln">
	ATTRIBUTE_NAME VARCHAR</span><span class="pun">(</span><span class="lit">200</span><span class="pun">)</span><span class="pln"> NOT NULL</span><span class="pun">,</span><span class="pln">
	ATTRIBUTE_BYTES BYTEA NOT NULL</span><span class="pun">,</span><span class="pln">
	CONSTRAINT SPRING_SESSION_ATTRIBUTES_PK PRIMARY KEY </span><span class="pun">(</span><span class="pln">SESSION_PRIMARY_ID</span><span class="pun">,</span><span class="pln"> ATTRIBUTE_NAME</span><span class="pun">),</span><span class="pln">
	CONSTRAINT SPRING_SESSION_ATTRIBUTES_FK FOREIGN KEY </span><span class="pun">(</span><span class="pln">SESSION_PRIMARY_ID</span><span class="pun">)</span><span class="pln"> REFERENCES SPRING_SESSION</span><span class="pun">(</span><span class="pln">PRIMARY_ID</span><span class="pun">)</span><span class="pln"> ON DELETE CASCADE
</span><span class="pun">);</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>With MySQL database, you can use the following script:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-sql" data-lang="sql"><span class="pln">CREATE TABLE SPRING_SESSION </span><span class="pun">(</span><span class="pln">
	PRIMARY_ID CHAR</span><span class="pun">(</span><span class="lit">36</span><span class="pun">)</span><span class="pln"> NOT NULL</span><span class="pun">,</span><span class="pln">
	SESSION_ID CHAR</span><span class="pun">(</span><span class="lit">36</span><span class="pun">)</span><span class="pln"> NOT NULL</span><span class="pun">,</span><span class="pln">
	CREATION_TIME BIGINT NOT NULL</span><span class="pun">,</span><span class="pln">
	LAST_ACCESS_TIME BIGINT NOT NULL</span><span class="pun">,</span><span class="pln">
	MAX_INACTIVE_INTERVAL INT NOT NULL</span><span class="pun">,</span><span class="pln">
	EXPIRY_TIME BIGINT NOT NULL</span><span class="pun">,</span><span class="pln">
	PRINCIPAL_NAME VARCHAR</span><span class="pun">(</span><span class="lit">100</span><span class="pun">),</span><span class="pln">
	CONSTRAINT SPRING_SESSION_PK PRIMARY KEY </span><span class="pun">(</span><span class="pln">PRIMARY_ID</span><span class="pun">)</span><span class="pln">
</span><span class="pun">)</span><span class="pln"> ENGINE</span><span class="pun">=</span><span class="typ">InnoDB</span><span class="pln"> ROW_FORMAT</span><span class="pun">=</span><span class="pln">DYNAMIC</span><span class="pun">;</span><span class="pln">

CREATE UNIQUE INDEX SPRING_SESSION_IX1 ON SPRING_SESSION </span><span class="pun">(</span><span class="pln">SESSION_ID</span><span class="pun">);</span><span class="pln">
CREATE INDEX SPRING_SESSION_IX2 ON SPRING_SESSION </span><span class="pun">(</span><span class="pln">EXPIRY_TIME</span><span class="pun">);</span><span class="pln">
CREATE INDEX SPRING_SESSION_IX3 ON SPRING_SESSION </span><span class="pun">(</span><span class="pln">PRINCIPAL_NAME</span><span class="pun">);</span><span class="pln">

CREATE TABLE SPRING_SESSION_ATTRIBUTES </span><span class="pun">(</span><span class="pln">
	SESSION_PRIMARY_ID CHAR</span><span class="pun">(</span><span class="lit">36</span><span class="pun">)</span><span class="pln"> NOT NULL</span><span class="pun">,</span><span class="pln">
	ATTRIBUTE_NAME VARCHAR</span><span class="pun">(</span><span class="lit">200</span><span class="pun">)</span><span class="pln"> NOT NULL</span><span class="pun">,</span><span class="pln">
	ATTRIBUTE_BYTES BLOB NOT NULL</span><span class="pun">,</span><span class="pln">
	CONSTRAINT SPRING_SESSION_ATTRIBUTES_PK PRIMARY KEY </span><span class="pun">(</span><span class="pln">SESSION_PRIMARY_ID</span><span class="pun">,</span><span class="pln"> ATTRIBUTE_NAME</span><span class="pun">),</span><span class="pln">
	CONSTRAINT SPRING_SESSION_ATTRIBUTES_FK FOREIGN KEY </span><span class="pun">(</span><span class="pln">SESSION_PRIMARY_ID</span><span class="pun">)</span><span class="pln"> REFERENCES SPRING_SESSION</span><span class="pun">(</span><span class="pln">PRIMARY_ID</span><span class="pun">)</span><span class="pln"> ON DELETE CASCADE
</span><span class="pun">)</span><span class="pln"> ENGINE</span><span class="pun">=</span><span class="typ">InnoDB</span><span class="pln"> ROW_FORMAT</span><span class="pun">=</span><span class="pln">DYNAMIC</span><span class="pun">;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="transaction-management"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#transaction-management"></a>9.11.4. Transaction Management</h4>
<div class="paragraph">
<p>All JDBC operations in <code>JdbcOperationsSessionRepository</code> are executed in a transactional manner.
Transactions are executed with propagation set to <code>REQUIRES_NEW</code> in order to avoid unexpected behavior due to interference with existing transactions (for example, running a <code>save</code> operation in a thread that already participates in a read-only transaction).</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="api-hazelcastsessionrepository"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-hazelcastsessionrepository"></a>9.12. Using <code>HazelcastSessionRepository</code></h3>
<div class="paragraph">
<p><code>HazelcastSessionRepository</code> is a <code>SessionRepository</code> implementation that stores sessions in Hazelcast’s distributed <code>IMap</code>.
In a web environment, this is typically used in combination with <code>SessionRepositoryFilter</code>.</p>
</div>
<div class="sect3">
<h4 id="api-hazelcastsessionrepository-new"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-hazelcastsessionrepository-new"></a>9.12.1. Instantiating a <code>HazelcastSessionRepository</code></h4>
<div class="paragraph">
<p>The following example shows how to create a new instance:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="typ">Config</span><span class="pln"> config </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Config</span><span class="pun">();</span><span class="pln">

</span><span class="com">// ... configure Hazelcast ...</span><span class="pln">

</span><span class="typ">HazelcastInstance</span><span class="pln"> hazelcastInstance </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Hazelcast</span><span class="pun">.</span><span class="pln">newHazelcastInstance</span><span class="pun">(</span><span class="pln">config</span><span class="pun">);</span><span class="pln">

</span><span class="typ">HazelcastSessionRepository</span><span class="pln"> repository </span><span class="pun">=</span><span class="pln">
		</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">HazelcastSessionRepository</span><span class="pun">(</span><span class="pln">hazelcastInstance</span><span class="pun">);</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>For additional information on how to create and configure Hazelcast instance, see the <a href="https://docs.hazelcast.org/docs/3.11.4/manual/html-single/index.html#hazelcast-configuration">Hazelcast documentation</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="api-enablehazelcasthttpsession"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-enablehazelcasthttpsession"></a>9.12.2. Using <code>@EnableHazelcastHttpSession</code></h4>
<div class="paragraph">
<p>To use <a href="https://hazelcast.org/">Hazelcast</a> as your backing source for the <code>SessionRepository</code>, you can add the <code>@EnableHazelcastHttpSession</code> annotation to a <code>@Configuration</code> class.
Doing so extends the functionality provided by the <code>@EnableSpringHttpSession</code> annotation but makes the <code>SessionRepository</code> for you in Hazelcast.
You must provide a single <code>HazelcastInstance</code> bean for the configuration to work.
You can find a complete configuration example in the <a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#samples">Samples and Guides (Start Here)</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="api-enablehazelcasthttpsession-customize"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-enablehazelcasthttpsession-customize"></a>9.12.3. Basic Customization</h4>
<div class="paragraph">
<p>You can use the following attributes on <code>@EnableHazelcastHttpSession</code> to customize the configuration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>maxInactiveIntervalInSeconds</strong>: The amount of time before the session expires, in seconds. The default is 1800 seconds (30 minutes)</p>
</li>
<li>
<p><strong>sessionMapName</strong>: The name of the distributed <code>Map</code> that is used in Hazelcast to store the session data.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="api-enablehazelcasthttpsession-events"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-enablehazelcasthttpsession-events"></a>9.12.4. Session Events</h4>
<div class="paragraph">
<p>Using a <code>MapListener</code> to respond to entries being added, evicted, and removed from the distributed <code>Map</code> causes these events to trigger publishing of <code>SessionCreatedEvent</code>, <code>SessionExpiredEvent</code>, and <code>SessionDeletedEvent</code> events (respectively) through the <code>ApplicationEventPublisher</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="api-enablehazelcasthttpsession-storage"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-enablehazelcasthttpsession-storage"></a>9.12.5. Storage Details</h4>
<div class="paragraph">
<p>Sessions are stored in a distributed <code>IMap</code> in Hazelcast.
The <code>IMap</code> interface methods are used to <code>get()</code> and <code>put()</code> Sessions.
Additionally, the <code>values()</code> method supports a <code>FindByIndexNameSessionRepository#findByIndexNameAndIndexValue</code> operation, together with appropriate <code>ValueExtractor</code> (which needs to be registered with Hazelcast). See the <a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#samples">Hazelcast Spring Sample</a> for more details on this configuration.
The expiration of a session in the <code>IMap</code> is handled by Hazelcast’s support for setting the time to live on an entry when it is <code>put()</code> into the <code>IMap</code>. Entries (sessions) that have been idle longer than the time to live are automatically removed from the <code>IMap</code>.</p>
</div>
<div class="paragraph">
<p>You should not need to configure any settings such as <code>max-idle-seconds</code> or <code>time-to-live-seconds</code> for the <code>IMap</code> within the Hazelcast configuration.</p>
</div>
<div class="paragraph">
<p>Note that if you use Hazelcast’s <code>MapStore</code> to persist your sessions <code>IMap</code>, the following limitations apply when reloading the sessions from <code>MapStore</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Reloading triggers <code>EntryAddedListener</code> results in <code>SessionCreatedEvent</code> being re-published</p>
</li>
<li>
<p>Reloading uses default TTL for a given <code>IMap</code> results in sessions losing their original TTL</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="custom-sessionrepository"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#custom-sessionrepository"></a>10. Customing <code>SessionRepository</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Implementing a custom <a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-sessionrepository"><code>SessionRepository</code></a> API should be a fairly straightforward task.
Coupling the custom implementation with <a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-enablespringhttpsession"><code>@EnableSpringHttpSession</code></a> support lets you reuse existing Spring Session configuration facilities and infrastructure.
There are, however, a couple of aspects that deserve closer consideration.</p>
</div>
<div class="paragraph">
<p>During the lifecycle of an HTTP request, the <code>HttpSession</code> is typically persisted to <code>SessionRepository</code> twice.
The first persist operation is to ensure that the session is available to the client as soon as the client has access to the session ID, and it is also necessary to write after the session is committed because further modifications to the session might be made.
Having this in mind, we generally recommend that a <code>SessionRepository</code> implementation keep track of changes to ensure that only deltas are saved.
This is particularly important in highly concurrent environments, where multiple requests operate on the same <code>HttpSession</code> and, therefore, cause race conditions, with requests overriding each other’s changes to session attributes.
All of the <code>SessionRepository</code> implementations provided by Spring Session use the described approach to persist session changes and can be used for guidance when you implement custom <code>SessionRepository</code>.</p>
</div>
<div class="paragraph">
<p>Note that the same recommendations apply for implementing a custom <a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-reactivesessionrepository"><code>ReactiveSessionRepository</code></a> as well.
In this case, you should use the <a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-enablespringwebsession"><code>@EnableSpringWebSession</code></a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="upgrading-2.0"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#upgrading-2.0"></a>11. Upgrading to 2.x</h2>
<div class="sectionbody">
<div class="paragraph">
<p>With the new major release version, the Spring Session team took the opportunity to make some non-passive changes.
The focus of these changes is to improve and harmonize Spring Session’s APIs as well as remove the deprecated components.</p>
</div>
<div class="sect2">
<h3 id="baseline-update"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#baseline-update"></a>11.1. Baseline Update</h3>
<div class="paragraph">
<p>Spring Session 2.0 requires Java 8 and Spring Framework 5.0 as a baseline, since its entire codebase is now based on Java 8 source code.
See <a href="https://github.com/spring-projects/spring-framework/wiki/Upgrading-to-Spring-Framework-5.x">Upgrading to Spring Framework 5.x</a> for more on upgrading Spring Framework.</p>
</div>
</div>
<div class="sect2">
<h3 id="replaced-and-removed-modules"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#replaced-and-removed-modules"></a>11.2. Replaced and Removed Modules</h3>
<div class="paragraph">
<p>As a part of the project’s splitting of the modules, the existing <code>spring-session</code> has been replaced with the <code>spring-session-core</code> module.
The <code>spring-session-core</code> module holds only the common set of APIs and components, while other modules contain the implementation of the appropriate <code>SessionRepository</code> and functionality related to that data store.
This applies to several existing modules that were previously a simple dependency aggregator helper module.
With new module arrangement, the following modules actually carry the implementation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Spring Session Data Redis</p>
</li>
<li>
<p>Spring Session JDBC</p>
</li>
<li>
<p>Spring Session Hazelcast</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Also, the following modules were removed from the main project repository:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Spring Session Data MongoDB</p>
</li>
<li>
<p>Spring Session Data GemFire</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that these two have moved to separate repositories and continue to be available under new artifact names:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/spring-projects/spring-session-data-mongodb"><code>spring-session-data-mongodb</code></a></p>
</li>
<li>
<p><a href="https://github.com/spring-projects/spring-session-data-geode"><code>spring-session-data-geode</code></a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="replaced-and-removed-packages-classes-and-methods"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#replaced-and-removed-packages-classes-and-methods"></a>11.3. Replaced and Removed Packages, Classes, and Methods</h3>
<div class="paragraph">
<p>The following changes were made to packages, classes, and methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ExpiringSession</code> API has been merged into the <code>Session</code> API.</p>
</li>
<li>
<p>The <code>Session</code> API has been enhanced to make full use of Java 8.</p>
</li>
<li>
<p>The <code>Session</code> API has been extended with <code>changeSessionId</code> support.</p>
</li>
<li>
<p>The <code>SessionRepository</code> API has been updated to better align with Spring Data method naming conventions.</p>
</li>
<li>
<p><code>AbstractSessionEvent</code> and its subclasses are no longer constructable without an underlying <code>Session</code> object.</p>
</li>
<li>
<p>The Redis namespace used by <code>RedisOperationsSessionRepository</code> is now fully configurable, instead of being partially configurable.</p>
</li>
<li>
<p>Redis configuration support has been updated to avoid registering a Spring Session-specific <code>RedisTemplate</code> bean.</p>
</li>
<li>
<p>JDBC configuration support has been updated to avoid registering a Spring Session-specific <code>JdbcTemplate</code> bean.</p>
</li>
<li>
<p>Previously deprecated classes and methods have been removed across the codebase</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="dropped-support"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#dropped-support"></a>11.4. Dropped Support</h3>
<div class="paragraph">
<p>As a part of the changes to <code>HttpSessionStrategy</code> and its alignment to the counterpart from the reactive world, the support for managing multiple users' sessions in a single browser instance has been removed.
The introduction of a new API to replace this functionality is under consideration for future releases.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="community"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#community"></a>12. Spring Session Community</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We are glad to consider you a part of our community.
The following sections provide additional about how to interact with the Spring Session community.</p>
</div>
<div class="sect2">
<h3 id="community-support"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#community-support"></a>12.1. Support</h3>
<div class="paragraph">
<p>You can get help by asking questions on <a href="https://stackoverflow.com/questions/tagged/spring-session">Stack Overflow with the <code>spring-session</code> tag</a>.
Similarly, we encourage helping others by answering questions on Stack Overflow.</p>
</div>
</div>
<div class="sect2">
<h3 id="community-source"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#community-source"></a>12.2. Source Code</h3>
<div class="paragraph">
<p>You can find the source code on GitHub at <a href="https://github.com/spring-projects/spring-session/" class="bare">https://github.com/spring-projects/spring-session/</a></p>
</div>
</div>
<div class="sect2">
<h3 id="community-issues"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#community-issues"></a>12.3. Issue Tracking</h3>
<div class="paragraph">
<p>We track issues in GitHub issues at <a href="https://github.com/spring-projects/spring-session/issues" class="bare">https://github.com/spring-projects/spring-session/issues</a></p>
</div>
</div>
<div class="sect2">
<h3 id="community-contributing"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#community-contributing"></a>12.4. Contributing</h3>
<div class="paragraph">
<p>We appreciate <a href="https://help.github.com/articles/using-pull-requests/">pull requests</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="community-license"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#community-license"></a>12.5. License</h3>
<div class="paragraph">
<p>Spring Session is Open Source software released under the <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 license</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="community-extensions"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#community-extensions"></a>12.6. Community Extensions</h3>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Location</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Spring Session OrientDB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/maseev/spring-session-orientdb" class="bare">https://github.com/maseev/spring-session-orientdb</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Spring Session Infinispan</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://infinispan.org/docs/dev/user_guide/user_guide.html#externalizing_session_using_spring_session" class="bare">https://infinispan.org/docs/dev/user_guide/user_guide.html#externalizing_session_using_spring_session</a></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="minimum-requirements"><a class="anchor" href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#minimum-requirements"></a>13. Minimum Requirements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The minimum requirements for Spring Session are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Java 8+.</p>
</li>
<li>
<p>If you run in a Servlet Container (not required), Servlet 3.1+.</p>
</li>
<li>
<p>If you use other Spring libraries (not required), the minimum required version is Spring 5.0.x.</p>
</li>
<li>
<p><code>@EnableRedisHttpSession</code> requires Redis 2.8+. This is necessary to support <a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-redisoperationssessionrepository-expiration">Session Expiration</a></p>
</li>
<li>
<p><code>@EnableHazelcastHttpSession</code> requires Hazelcast 3.6+. This is necessary to support <a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#api-enablehazelcasthttpsession-storage"><code>FindByIndexNameSessionRepository</code></a></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
At its core, Spring Session has a required dependency only on <code>spring-jcl</code>.
For an example of using Spring Session without any other Spring dependencies, see the <a href="https://docs.spring.io/spring-session/docs/2.1.6.BUILD-SNAPSHOT/reference/html5/#samples">hazelcast sample</a> application.
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 2.1.6.BUILD-SNAPSHOT<br>
Last updated 2019-05-08 12:53:39 +00:00
</div>
</div>
<link rel="stylesheet" href="./Spring Session_files/prettify.min.css">
<script async="" src="./Spring Session_files/analytics.js.下载"></script><script src="./Spring Session_files/prettify.min.js.下载"></script>
<script>prettyPrint()</script>
<script>if(window.parent==window){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-2728886-23','auto',{'siteSpeedSampleRate':100});ga('send','pageview');}</script>
<iframe id="blockbyte-bs-sidebar" class="notranslate blockbyte-bs-hideMask" data-pos="left" src="./Spring Session_files/saved_resource.html"></iframe><div id="blockbyte-bs-indicator" style="width: 2px; height: 59%; top: 0%;"></div></body></html>